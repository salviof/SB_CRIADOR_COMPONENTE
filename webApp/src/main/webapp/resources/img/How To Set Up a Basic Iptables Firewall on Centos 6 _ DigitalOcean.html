<!DOCTYPE html>
<!-- saved from url=(0100)https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6 -->
<html lang="en" class="wf-proximanova-n6-active wf-proximanova-n4-active wf-proximanova-i4-active wf-proximanova-n3-active wf-active" style=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script type="text/javascript" async="" src="./How To Set Up a Basic Iptables Firewall on Centos 6 _ DigitalOcean_files/linkid.js"></script><script async="" id="demandbase_js_lib" src="./How To Set Up a Basic Iptables Firewall on Centos 6 _ DigitalOcean_files/014ab3bd.min.js"></script><script type="text/javascript" async="" src="./How To Set Up a Basic Iptables Firewall on Centos 6 _ DigitalOcean_files/analytics.js"></script><script type="text/javascript" async="" src="./How To Set Up a Basic Iptables Firewall on Centos 6 _ DigitalOcean_files/qevents.js"></script>
    <title>How To Set Up a Basic Iptables Firewall on Centos 6 | DigitalOcean</title>

<meta name="description" content="This article will show how to create a simple firewall on a Centos VPS. It will only open up ports that we want and close up other services. We&#39;ll also demonstrate how to prevent simpler attacks, and how to let yourself back in to the VPS if you deny">
<meta name="keywords" content="Firewall Security">

<meta name="og:title" content="How To Set Up a Basic Iptables Firewall on Centos 6 | DigitalOcean">
<meta name="og:description" content="This article will show how to create a simple firewall on a Centos VPS. It will only open up ports that we want and close up other services. We&#39;ll also demonstrate how to prevent simpler attacks, and how to let yourself back in to the VPS if you deny">
<meta name="og:site_name" content="DigitalOcean">
<meta name="og:type" content="article">

<meta name="twitter:site" content="DigitalOcean">
<meta name="twitter:title" content="How To Set Up a Basic Iptables Firewall on Centos 6 | DigitalOcean">
<meta name="twitter:description" content="This article will show how to create a simple firewall on a Centos VPS. It will only open up ports that we want and close up other services. We&#39;ll also demonstrate how to prevent simpler attacks, and how to let yourself back in to the VPS if you deny">
<meta name="twitter:creator" content="DigitalOcean">
<meta name="twitter:card" content="photo">
<meta name="twitter:url" content="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6">

<meta property="og:image" content="https://www.digitalocean.com/assets/community/default_community_sharing-65c1cc547375d6e37cc45195b3686769.png">
<meta name="twitter:image" content="https://www.digitalocean.com/assets/community/default_community_sharing-65c1cc547375d6e37cc45195b3686769.png">

  <link rel="canonical" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6">


    <link rel="stylesheet" media="all" href="./How To Set Up a Basic Iptables Firewall on Centos 6 _ DigitalOcean_files/application-ccb19293f77f19cebf2ec058e4015515.css">

    
    <meta name="csrf-param" content="authenticity_token">
<meta name="csrf-token" content="nVr9Sz6d9Bh/ACaQQfSSjOfBt1mzxepL72M+GE8cE6nFNLPz+ADcmZSnDPdlFA9nfxxLMHe6HhZg2DYH/Yx7Xg==">
      <script async="" src="./How To Set Up a Basic Iptables Firewall on Centos 6 _ DigitalOcean_files/gtm.js"></script><script type="text/javascript" async="" src="./How To Set Up a Basic Iptables Firewall on Centos 6 _ DigitalOcean_files/analytics.min.js"></script><script src="./How To Set Up a Basic Iptables Firewall on Centos 6 _ DigitalOcean_files/izu1uqu.js"></script>
      <style type="text/css">.tk-proxima-nova{font-family:"proxima-nova",sans-serif;}</style><style type="text/css">@font-face{font-family:tk-proxima-nova-n6;src:url(https://use.typekit.net/af/610d30/00000000000000003b9ad1bb/27/l?subset_id=2&fvd=n6&v=3) format("woff2"),url(https://use.typekit.net/af/610d30/00000000000000003b9ad1bb/27/d?subset_id=2&fvd=n6&v=3) format("woff"),url(https://use.typekit.net/af/610d30/00000000000000003b9ad1bb/27/a?subset_id=2&fvd=n6&v=3) format("opentype");font-weight:600;font-style:normal;}@font-face{font-family:tk-proxima-nova-n4;src:url(https://use.typekit.net/af/1f8eae/00000000000000003b9ad1b9/27/l?subset_id=2&fvd=n4&v=3) format("woff2"),url(https://use.typekit.net/af/1f8eae/00000000000000003b9ad1b9/27/d?subset_id=2&fvd=n4&v=3) format("woff"),url(https://use.typekit.net/af/1f8eae/00000000000000003b9ad1b9/27/a?subset_id=2&fvd=n4&v=3) format("opentype");font-weight:400;font-style:normal;}@font-face{font-family:tk-proxima-nova-i4;src:url(https://use.typekit.net/af/ca838d/00000000000000003b9ad1ba/27/l?subset_id=2&fvd=i4&v=3) format("woff2"),url(https://use.typekit.net/af/ca838d/00000000000000003b9ad1ba/27/d?subset_id=2&fvd=i4&v=3) format("woff"),url(https://use.typekit.net/af/ca838d/00000000000000003b9ad1ba/27/a?subset_id=2&fvd=i4&v=3) format("opentype");font-weight:400;font-style:italic;}@font-face{font-family:tk-proxima-nova-n3;src:url(https://use.typekit.net/af/c2fb26/00000000000000003b9ad1b5/27/l?subset_id=2&fvd=n3&v=3) format("woff2"),url(https://use.typekit.net/af/c2fb26/00000000000000003b9ad1b5/27/d?subset_id=2&fvd=n3&v=3) format("woff"),url(https://use.typekit.net/af/c2fb26/00000000000000003b9ad1b5/27/a?subset_id=2&fvd=n3&v=3) format("opentype");font-weight:300;font-style:normal;}</style><script>try{Typekit.load({ async: true });}catch(e){}</script>
      <script src="./How To Set Up a Basic Iptables Firewall on Centos 6 _ DigitalOcean_files/polyfill.min.js"></script>
    <script src="./How To Set Up a Basic Iptables Firewall on Centos 6 _ DigitalOcean_files/bugsnag-2.min.js" data-apikey="9ffc01bc3e1fa7891bfd20909d1bfb0e">
    </script>
    <script type="text/javascript">
      if(window.analytics=window.analytics||[],window.analytics.included)window.console&&console.error&&console.error("analytics.js included twice");else{window.analytics.included=!0,window.analytics.methods=["identify","group","track","page","pageview","alias","ready","on","once","off","trackLink","trackForm","trackClick","trackSubmit"],window.analytics.factory=function(a){return function(){var n=Array.prototype.slice.call(arguments);return n.unshift(a),window.analytics.push(n),window.analytics}};for(var i=0;i<window.analytics.methods.length;i++){var key=window.analytics.methods[i];window.analytics[key]=window.analytics.factory(key)}window.analytics.load=function(a){var n=document.createElement("script");n.type="text/javascript",n.async=!0,n.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+a+"/analytics.min.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(n,t)},window.analytics.SNIPPET_VERSION="2.0.9",
      window.analytics.load("puo3uv968t")}
      window.analytics.page();
    </script>
    <meta name="viewport" content="initial-scale=1, maximum-scale=1">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="https://www.digitalocean.com/community/tutorials/feed">
    <script>
      window.comApp = {
        prefix: '/community',
        svgIconPath: 'https://www.digitalocean.com/assets/community/icon-sprite-d76eb75d70ccf8ffb4c0b47b7dbc88ca.svg',
        railsEnv: 'production',
        rootUrl: 'https://www.digitalocean.com/community'
      };
    </script>
      <script src="./How To Set Up a Basic Iptables Firewall on Centos 6 _ DigitalOcean_files/forms2.min.js"></script>

    <script src="./How To Set Up a Basic Iptables Firewall on Centos 6 _ DigitalOcean_files/application-ed83ed45704e8c3619c0698b180fdc77.js"></script>
  <style>.fluidvids {width: 100%; max-width: 100%; position: relative;}.fluidvids-item {position: absolute; top: 0px; left: 0px; width: 100%; height: 100%;}</style><script id="twitter-wjs" src="./How To Set Up a Basic Iptables Firewall on Centos 6 _ DigitalOcean_files/widgets.js"></script><style type="text/css">@font-face{font-family:proxima-nova;src:url(https://use.typekit.net/af/610d30/00000000000000003b9ad1bb/27/l?subset_id=2&fvd=n6&v=3) format("woff2"),url(https://use.typekit.net/af/610d30/00000000000000003b9ad1bb/27/d?subset_id=2&fvd=n6&v=3) format("woff"),url(https://use.typekit.net/af/610d30/00000000000000003b9ad1bb/27/a?subset_id=2&fvd=n6&v=3) format("opentype");font-weight:600;font-style:normal;}@font-face{font-family:proxima-nova;src:url(https://use.typekit.net/af/1f8eae/00000000000000003b9ad1b9/27/l?subset_id=2&fvd=n4&v=3) format("woff2"),url(https://use.typekit.net/af/1f8eae/00000000000000003b9ad1b9/27/d?subset_id=2&fvd=n4&v=3) format("woff"),url(https://use.typekit.net/af/1f8eae/00000000000000003b9ad1b9/27/a?subset_id=2&fvd=n4&v=3) format("opentype");font-weight:400;font-style:normal;}@font-face{font-family:proxima-nova;src:url(https://use.typekit.net/af/ca838d/00000000000000003b9ad1ba/27/l?subset_id=2&fvd=i4&v=3) format("woff2"),url(https://use.typekit.net/af/ca838d/00000000000000003b9ad1ba/27/d?subset_id=2&fvd=i4&v=3) format("woff"),url(https://use.typekit.net/af/ca838d/00000000000000003b9ad1ba/27/a?subset_id=2&fvd=i4&v=3) format("opentype");font-weight:400;font-style:italic;}@font-face{font-family:proxima-nova;src:url(https://use.typekit.net/af/c2fb26/00000000000000003b9ad1b5/27/l?subset_id=2&fvd=n3&v=3) format("woff2"),url(https://use.typekit.net/af/c2fb26/00000000000000003b9ad1b5/27/d?subset_id=2&fvd=n3&v=3) format("woff"),url(https://use.typekit.net/af/c2fb26/00000000000000003b9ad1b5/27/a?subset_id=2&fvd=n3&v=3) format("opentype");font-weight:300;font-style:normal;}</style><script id="facebook-jssdk" src="./How To Set Up a Basic Iptables Firewall on Centos 6 _ DigitalOcean_files/all.js"></script><link id="mktoForms2BaseStyle" rel="stylesheet" type="text/css" href="./How To Set Up a Basic Iptables Firewall on Centos 6 _ DigitalOcean_files/forms2.css"><link id="mktoForms2ThemeStyle" rel="stylesheet" type="text/css" href="./How To Set Up a Basic Iptables Firewall on Centos 6 _ DigitalOcean_files/forms2-theme-simple.css"><style type="text/css">.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_reposition{overflow:hidden;position:relative}.fb_invisible{display:none}.fb_reset{background:none;border:0;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}.fb_link img{border:none}@keyframes fb_transform{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.fb_animate{animation:fb_transform .3s forwards}
.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}.fb_reset .fb_dialog_legacy{overflow:visible}.fb_dialog_advanced{padding:10px;-moz-border-radius:8px;-webkit-border-radius:8px;border-radius:8px}.fb_dialog_content{background:#fff;color:#333}.fb_dialog_close_icon{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px}.fb_dialog_mobile .fb_dialog_close_icon{top:5px;left:5px;right:auto}.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}.fb_dialog_close_icon:hover{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent}.fb_dialog_close_icon:active{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent}.fb_dialog_loader{background-color:#f6f7f9;border:1px solid #606060;font-size:24px;padding:20px}.fb_dialog_top_left,.fb_dialog_top_right,.fb_dialog_bottom_left,.fb_dialog_bottom_right{height:10px;width:10px;overflow:hidden;position:absolute}.fb_dialog_top_left{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 0;left:-10px;top:-10px}.fb_dialog_top_right{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -10px;right:-10px;top:-10px}.fb_dialog_bottom_left{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -20px;bottom:-10px;left:-10px}.fb_dialog_bottom_right{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -30px;right:-10px;bottom:-10px}.fb_dialog_vert_left,.fb_dialog_vert_right,.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{position:absolute;background:#525252;filter:alpha(opacity=70);opacity:.7}.fb_dialog_vert_left,.fb_dialog_vert_right{width:10px;height:100%}.fb_dialog_vert_left{margin-left:-10px}.fb_dialog_vert_right{right:0;margin-right:-10px}.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{width:100%;height:10px}.fb_dialog_horiz_top{margin-top:-10px}.fb_dialog_horiz_bottom{bottom:0;margin-bottom:-10px}.fb_dialog_iframe{line-height:0}.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #365899;color:#fff;font-size:14px;font-weight:bold;margin:0}.fb_dialog_content .dialog_title>span{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yd/r/Cou7n-nqK52.gif) no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}body.fb_hidden{-webkit-transform:none;height:100%;margin:0;overflow:visible;position:absolute;top:-10000px;left:0;width:100%}.fb_dialog.fb_dialog_mobile.loading{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ya/r/3rhSv5V8j3o.gif) white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}.fb_dialog.fb_dialog_mobile.loading.centered{width:auto;height:auto;min-height:initial;min-width:initial;background:none}.fb_dialog.fb_dialog_mobile.loading.centered #fb_dialog_loader_spinner{width:100%}.fb_dialog.fb_dialog_mobile.loading.centered .fb_dialog_content{background:none}.loading.centered #fb_dialog_loader_close{color:#fff;display:block;padding-top:20px;clear:both;font-size:18px}#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .45);position:absolute;bottom:0;left:0;right:0;top:0;width:100%;min-height:100%;z-index:10000}#fb-root #fb_dialog_ipad_overlay.hidden{display:none}.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}.fb_dialog_content .dialog_header{-webkit-box-shadow:white 0 1px 1px -1px inset;background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#738ABA), to(#2C4987));border-bottom:1px solid;border-color:#1d4088;color:#fff;font:14px Helvetica, sans-serif;font-weight:bold;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}.fb_dialog_content .dialog_header table{-webkit-font-smoothing:subpixel-antialiased;height:43px;width:100%}.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px}.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px}.fb_dialog_content .touchable_button{background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#4966A6), color-stop(.5, #355492), to(#2A4887));border:1px solid #29487d;-webkit-background-clip:padding-box;-webkit-border-radius:3px;-webkit-box-shadow:rgba(0, 0, 0, .117188) 0 1px 1px inset, rgba(255, 255, 255, .167969) 0 1px 0;display:inline-block;margin-top:3px;max-width:85px;line-height:18px;padding:4px 12px;position:relative}.fb_dialog_content .dialog_header .touchable_button input{border:none;background:none;color:#fff;font:12px Helvetica, sans-serif;font-weight:bold;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}.fb_dialog_content .dialog_content{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #555;border-bottom:0;border-top:0;height:150px}.fb_dialog_content .dialog_footer{background:#f6f7f9;border:1px solid #555;border-top-color:#ccc;height:40px}#fb_dialog_loader_close{float:left}.fb_dialog.fb_dialog_mobile .fb_dialog_close_button{text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}#fb_dialog_loader_spinner{animation:rotateSpinner 1.2s linear infinite;background-color:transparent;background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yD/r/t-wz8gw1xG1.png);background-repeat:no-repeat;background-position:50% 50%;height:24px;width:24px}@keyframes rotateSpinner{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
.fb_iframe_widget{display:inline-block;position:relative}.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}.fb_iframe_widget iframe{position:absolute}.fb_iframe_widget_fluid_desktop,.fb_iframe_widget_fluid_desktop span,.fb_iframe_widget_fluid_desktop iframe{max-width:100%}.fb_iframe_widget_fluid_desktop iframe{min-width:220px;position:relative}.fb_iframe_widget_lift{z-index:1}.fb_hide_iframes iframe{position:relative;left:-10000px}.fb_iframe_widget_loader{position:relative;display:inline-block}.fb_iframe_widget_fluid{display:inline}.fb_iframe_widget_fluid span{width:100%}.fb_iframe_widget_loader iframe{min-height:32px;z-index:2;zoom:1}.fb_iframe_widget_loader .FB_Loader{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat;height:32px;width:32px;margin-left:-16px;position:absolute;left:50%;z-index:4}
.fb_invisible_flow{display:inherit;height:0;overflow-x:hidden;width:0}.fb_mobile_overlay_active{height:100%;overflow:hidden;position:fixed;width:100%}.fb_shrink_active{opacity:1;transform:scale(1, 1);transition-duration:200ms;transition-timing-function:ease-out}.fb_shrink_active:active{opacity:.5;transform:scale(.75, .75)}</style></head>
  <body class="feature-filter-bar feature-upvotes tutorials-controller tutorial-single" data-env="production" data-prefix="/community" data-user-id="" data-facebook-app-id="694818843983011" data-completed-tutorial-id="" data-tutorial-id="245" data-js="tutorial">
    <script>
//<![CDATA[

//]]>
</script>
<!-- Google Tag Manager -->
<noscript>&lt;iframe src="//www.googletagmanager.com/ns.html?id=GTM-KHWBBT"
height="0" width="0" style="display:none;visibility:hidden"&gt;&lt;/iframe&gt;</noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KHWBBT');</script>
<!-- End Google Tag Manager -->

    

    <div class="outside_viewport">
        <div id="contents-modal" class="modal fade mini-modal" style="display: none;">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1>Contents</h1>
          <button class="close-button icon icon-close-light" data-dismiss="modal" aria-label="close"></button>
        </div>
        <div class="modal-body">
          <div class="table-of-contents-modal tocify"><ul id="tocify-header0" class="tocify-header"><li class="tocify-item" data-unique="decide-which-ports-and-services-to-open"><a>Decide which ports and services to open</a></li></ul><ul id="tocify-header1" class="tocify-header"><li class="tocify-item" data-unique="block-the-most-common-attacks"><a>Block the most common attacks</a></li></ul><ul id="tocify-header2" class="tocify-header"><li class="tocify-item" data-unique="open-up-ports-for-selected-services"><a>Open up ports for selected services</a></li></ul><ul id="tocify-header3" class="tocify-header"><li class="tocify-item" data-unique="limiting-ssh-access"><a>Limiting SSH access</a></li></ul><ul id="tocify-header4" class="tocify-header"><li class="tocify-item tocify-focus" data-unique="save-the-configuration"><a>Save the configuration</a></li></ul><ul id="tocify-header5" class="tocify-header"><li class="tocify-item" data-unique="flush-to-unlock-yourself"><a>Flush to unlock yourself</a></li></ul><ul id="tocify-header6" class="tocify-header"><li class="tocify-item" data-unique="conclusion"><a>Conclusion</a></li></ul></div>
        </div>
      </div>
    </div>
  </div>
  <div id="share-modal" class="modal fade mini-modal" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1>Share</h1>
        <button type="button" class="close-button icon icon-close-light" aria-label="close" data-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <div class="social-sharing social-sharing-container">
          <ul class="top ">
            <li class="shareBtn" id="sbTwitter">
              <a href="http://twitter.com/share?text=How%20To%20Set%20Up%20a%20Basic%20Iptables%20Firewall%20on%20Centos%206&amp;url=https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6?utm_content=how-to-set-up-a-basic-iptables-firewall-on-centos-6&amp;utm_medium=community&amp;utm_source=twshare" class="share-icon share-popup" title="Share on Twitter">
                <span class="sIcon icon-bird"></span>
              </a>
              <a href="http://twitter.com/share?text=How%20To%20Set%20Up%20a%20Basic%20Iptables%20Firewall%20on%20Centos%206&amp;url=https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6?utm_content=how-to-set-up-a-basic-iptables-firewall-on-centos-6&amp;utm_medium=community&amp;utm_source=twshare" class="share-link share-popup" title="Share on Twitter">
                Twitter
              </a>
            </li>
            <li class="shareBtn" id="sbFacebook">
              <a class="share-icon facebook-share" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6?utm_content=how-to-set-up-a-basic-iptables-firewall-on-centos-6&amp;utm_medium=community&amp;utm_source=fbshare" onclick="" title="Share on Facebook">
                <span class="sIcon icon-facebook-B"></span>
              </a>

              <a class="share-link facebook-share" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6?utm_content=how-to-set-up-a-basic-iptables-firewall-on-centos-6&amp;utm_medium=community&amp;utm_source=fbshare" onclick="" title="Share on Facebook">
                Facebook
              </a>
            </li>
            <li class="shareBtn" id="sbGoogle">
              <a href="https://plus.google.com/share?url=https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6?utm_content=how-to-set-up-a-basic-iptables-firewall-on-centos-6&amp;utm_medium=community&amp;utm_source=gpshare" class="share-icon share-popup" title="Share on Google+">
                <span class="sIcon icon-google-plus-B"></span>
              </a>
              <a href="https://plus.google.com/share?url=https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6?utm_content=how-to-set-up-a-basic-iptables-firewall-on-centos-6&amp;utm_medium=community&amp;utm_source=gpshare" class="share-link share-popup" title="Share on Google+">
                Google+
              </a>
            </li>
            <li class="shareBtn" id="sbYC">
              <a href="https://news.ycombinator.com/submitlink?t=How%20To%20Set%20Up%20a%20Basic%20Iptables%20Firewall%20on%20Centos%206&amp;u=https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6?utm_content=how-to-set-up-a-basic-iptables-firewall-on-centos-6&amp;utm_medium=community&amp;utm_source=hnshare" class="share-icon share-popup" target="_blank" title="Submit to Hacker News">
                <span class="sIcon icon-hacker-news"></span>
              </a>
              <a href="https://news.ycombinator.com/submitlink?t=How%20To%20Set%20Up%20a%20Basic%20Iptables%20Firewall%20on%20Centos%206&amp;u=https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6?utm_content=how-to-set-up-a-basic-iptables-firewall-on-centos-6&amp;utm_medium=community&amp;utm_source=hnshare" class="share-link share-popup" target="_blank" title="Submit to Hacker News">
                Hacker News
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  <div class="table-of-contents has-init sticky" style="top: 72px;">
    <div data-js="tableOfContentsDesktop" class="tocify"><ul id="tocify-header0" class="tocify-header"><li class="tocify-item" data-unique="decide-which-ports-and-services-to-open"><a>Decide which ports and services to open</a></li></ul><ul id="tocify-header1" class="tocify-header"><li class="tocify-item" data-unique="block-the-most-common-attacks"><a>Block the most common attacks</a></li></ul><ul id="tocify-header2" class="tocify-header"><li class="tocify-item" data-unique="open-up-ports-for-selected-services"><a>Open up ports for selected services</a></li></ul><ul id="tocify-header3" class="tocify-header"><li class="tocify-item" data-unique="limiting-ssh-access"><a>Limiting SSH access</a></li></ul><ul id="tocify-header4" class="tocify-header"><li class="tocify-item tocify-focus" data-unique="save-the-configuration"><a>Save the configuration</a></li></ul><ul id="tocify-header5" class="tocify-header"><li class="tocify-item" data-unique="flush-to-unlock-yourself"><a>Flush to unlock yourself</a></li></ul><ul id="tocify-header6" class="tocify-header"><li class="tocify-item" data-unique="conclusion"><a>Conclusion</a></li></ul></div>
    <button type="button" class="Button--reset Tutorial-button " data-js="markAsComplete" data-tutorialinteraction="" data-tutorialsingle=""><svg class="svg-icon svg-icon-completed"><use xlink:href="https://www.digitalocean.com/assets/community/icon-sprite-d76eb75d70ccf8ffb4c0b47b7dbc88ca.svg#icon-completed"></use></svg><span>Mark as Complete</span></button>
  </div>
  
  <div id="share-modal" class="modal fade mini-modal" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1>Share</h1>
        <button type="button" class="close-button icon icon-close-light" aria-label="close" data-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <div class="social-sharing social-sharing-container">
          <ul class="bottom ">
            <li class="shareBtn" id="sbTwitter">
              <a href="http://twitter.com/share?text=How%20To%20Set%20Up%20a%20Basic%20Iptables%20Firewall%20on%20Centos%206&amp;url=https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6?utm_content=how-to-set-up-a-basic-iptables-firewall-on-centos-6&amp;utm_medium=community&amp;utm_source=twshare" class="share-icon share-popup" title="Share on Twitter">
                <span class="sIcon icon-bird"></span>
              </a>
              <a href="http://twitter.com/share?text=How%20To%20Set%20Up%20a%20Basic%20Iptables%20Firewall%20on%20Centos%206&amp;url=https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6?utm_content=how-to-set-up-a-basic-iptables-firewall-on-centos-6&amp;utm_medium=community&amp;utm_source=twshare" class="share-link share-popup" title="Share on Twitter">
                Twitter
              </a>
            </li>
            <li class="shareBtn" id="sbFacebook">
              <a class="share-icon facebook-share" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6?utm_content=how-to-set-up-a-basic-iptables-firewall-on-centos-6&amp;utm_medium=community&amp;utm_source=fbshare" onclick="" title="Share on Facebook">
                <span class="sIcon icon-facebook-B"></span>
              </a>

              <a class="share-link facebook-share" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6?utm_content=how-to-set-up-a-basic-iptables-firewall-on-centos-6&amp;utm_medium=community&amp;utm_source=fbshare" onclick="" title="Share on Facebook">
                Facebook
              </a>
            </li>
            <li class="shareBtn" id="sbGoogle">
              <a href="https://plus.google.com/share?url=https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6?utm_content=how-to-set-up-a-basic-iptables-firewall-on-centos-6&amp;utm_medium=community&amp;utm_source=gpshare" class="share-icon share-popup" title="Share on Google+">
                <span class="sIcon icon-google-plus-B"></span>
              </a>
              <a href="https://plus.google.com/share?url=https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6?utm_content=how-to-set-up-a-basic-iptables-firewall-on-centos-6&amp;utm_medium=community&amp;utm_source=gpshare" class="share-link share-popup" title="Share on Google+">
                Google+
              </a>
            </li>
            <li class="shareBtn" id="sbYC">
              <a href="https://news.ycombinator.com/submitlink?t=How%20To%20Set%20Up%20a%20Basic%20Iptables%20Firewall%20on%20Centos%206&amp;u=https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6?utm_content=how-to-set-up-a-basic-iptables-firewall-on-centos-6&amp;utm_medium=community&amp;utm_source=hnshare" class="share-icon share-popup" target="_blank" title="Submit to Hacker News">
                <span class="sIcon icon-hacker-news"></span>
              </a>
              <a href="https://news.ycombinator.com/submitlink?t=How%20To%20Set%20Up%20a%20Basic%20Iptables%20Firewall%20on%20Centos%206&amp;u=https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6?utm_content=how-to-set-up-a-basic-iptables-firewall-on-centos-6&amp;utm_medium=community&amp;utm_source=hnshare" class="share-link share-popup" target="_blank" title="Submit to Hacker News">
                Hacker News
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

    <div id="newsletter-signup-dialog" class="newsletter-signups-dialog reveal" data-newsletter-signup-dialog="" data-article-target=".content-body">
  <div class="form-message">
  <div class="pull-right">
    <a href="javascript:;" class="newsletter-signups-dialog-dismiss" data-newsletter-signup-dismiss="">×</a>

  </div>
  <h4 class="newsletter-signups-dialog-title">
    Sign up for our newsletter.
  </h4>
  <p class="newsletter-signups-dialog-description">
    Get the latest tutorials on SysAdmin and open source topics.
  </p>
  <form class="newsletter-signup" id="new_newsletter_signup" data-newsletter-signup="true" action="https://www.digitalocean.com/community/newsletter" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="✓">

  <input data-newsletter-signup-field="url" type="hidden" name="newsletter_signup[url]" id="newsletter_signup_url">
  <input data-newsletter-signup-field="title" type="hidden" name="newsletter_signup[title]" id="newsletter_signup_title">

  <div class="newsletter-signup-ajax-error" data-newsletter-signup-ajax-error=""></div>


  <div class="form-group">
    <input placeholder="Enter your email address" required="required" class="field" type="email" name="newsletter_signup[email]" id="newsletter_signup_email">
  </div>

  <button data-disable-with="Sign Up" class="button blue-button">
    Sign Up
  </button>

</form>

</div>

<div class="thanks-message hidden" data-newsletter-signup-successful=""> 
  <div class="pull-right"> 
    <a href="javascript:;" class="newsletter-signups-dialog-dismiss icon icon-close-light" data-newsletter-signup-dismiss=""></a> 
  </div> 

  <span class="newsletter-signups-dialog-success"> 
    Thanks for signing up! 
  </span> 
</div>

</div>


      
    </div>

      <div class="mobile-nav">
  
<div class="account-buttons">
    <div id="entrance">
      <a id="sign-up" class="button" href="https://www.digitalocean.com/community/auth/digitalocean?display=sessionless+register">Sign Up</a>
      <a id="log-in" class="button" href="https://www.digitalocean.com/community/auth/digitalocean">Log In</a>
    </div>
</div>

  <button type="button" aria-label="close" class="close-panel icon-close"></button>

  <form class="mobile-search" role="search" action="https://www.digitalocean.com/community/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="✓">
    <span class="icon icon-search-thin"></span>
    <input type="text" name="q" id="q" title="Search" placeholder="Search">
    <button name="button" type="submit" class="icon-btn">submit</button>
</form>
  
<nav>

  <ul>
    <li><a class="active" href="https://www.digitalocean.com/community/tutorials">Tutorials</a></li>
    <li><a href="https://www.digitalocean.com/community/questions">Questions</a></li>
    <li><a href="https://www.digitalocean.com/community/projects">Projects</a></li>
    <li><a href="https://www.meetup.com/pro/digitalocean/?utm_source=do_community" target="_blank">Meetups</a></li>
    <li class="mobile-nav-only"><a href="https://www.digitalocean.com/">Main Site</a></li>
  </ul>
</nav>

  
</div>

      
      <header>
  <div class="flash-container"></div>

  <div class="main-menu-container">
    <div class="wrapper">
      <div class="logo">
        <a class="logo-icon" href="https://www.digitalocean.com/">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 190 32" class="do-icon">
<title>DigitalOcean</title>
<path class="path1" d="M16.016 32v-6.204c6.584 0 11.648-6.52 9.147-13.42-0.95-2.564-2.975-4.59-5.539-5.539-6.9-2.501-13.42 2.564-13.42 9.147 0 0 0 0 0 0l-6.204 0.032c0-10.477 10.129-18.643 21.112-15.225 4.811 1.488 8.609 5.317 10.097 10.097 3.418 10.983-4.716 21.112-15.193 21.112z"></path>
<path class="path2" d="M16.016 25.828h-6.172v-6.172h6.172z"></path>
<path class="path3" d="M9.844 30.576h-4.748v-4.748h4.748v4.748z"></path>
<path class="path4" d="M5.096 25.828h-3.988v-3.988h3.988z"></path>
<path class="path5" d="M56.973 9.242c-1.836-1.266-4.115-1.931-6.773-1.931h-5.792v18.39h5.792c2.659 0 4.938-0.665 6.773-2.026 1.013-0.696 1.804-1.709 2.342-2.944s0.823-2.69 0.823-4.336c0-1.614-0.285-3.070-0.823-4.305-0.538-1.203-1.329-2.152-2.342-2.849zM47.794 10.445h1.836c2.026 0 3.703 0.411 4.969 1.171 1.393 0.855 2.121 2.469 2.121 4.779 0 2.406-0.728 4.083-2.121 5.001v0c-1.203 0.791-2.88 1.203-4.938 1.203h-1.867v-12.154z"></path>
<path class="path6" d="M64.19 7.122c-0.57 0-1.044 0.19-1.424 0.57s-0.601 0.855-0.601 1.393c0 0.57 0.19 1.044 0.601 1.424 0.38 0.38 0.855 0.601 1.424 0.601s1.044-0.19 1.424-0.601c0.38-0.38 0.601-0.886 0.601-1.424 0-0.57-0.19-1.044-0.601-1.393-0.38-0.38-0.886-0.57-1.424-0.57z"></path>
<path class="path7" d="M62.512 12.787h3.26v12.977h-3.26v-12.977z"></path>
<path class="path8" d="M77.642 13.864c-0.981-0.886-2.089-1.393-3.26-1.393-1.804 0-3.292 0.633-4.463 1.836s-1.741 2.785-1.741 4.653c0 1.836 0.57 3.387 1.741 4.653 1.171 1.203 2.659 1.836 4.463 1.836 1.266 0 2.342-0.348 3.228-1.044v0.285c0 1.076-0.285 1.899-0.855 2.5-0.57 0.57-1.361 0.855-2.342 0.855-1.519 0-2.437-0.601-3.608-2.152l-2.216 2.121 0.063 0.095c0.475 0.665 1.203 1.329 2.184 1.962s2.184 0.95 3.64 0.95c1.931 0 3.513-0.601 4.653-1.773 1.171-1.171 1.741-2.754 1.741-4.716v-11.743h-3.197v1.076zM76.787 21.523c-0.57 0.633-1.298 0.95-2.247 0.95s-1.678-0.317-2.216-0.95c-0.57-0.633-0.855-1.488-0.855-2.532s0.285-1.931 0.855-2.564c0.57-0.633 1.298-0.981 2.216-0.981 0.95 0 1.678 0.317 2.247 0.981 0.57 0.633 0.855 1.519 0.855 2.564s-0.317 1.899-0.855 2.532z"></path>
<path class="path9" d="M83.624 12.787h3.26v12.977h-3.26v-12.977z"></path>
<path class="path10" d="M85.302 7.122c-0.57 0-1.044 0.19-1.424 0.57s-0.601 0.855-0.601 1.393c0 0.57 0.19 1.044 0.601 1.424 0.38 0.38 0.855 0.601 1.424 0.601s1.044-0.19 1.424-0.601c0.38-0.38 0.601-0.886 0.601-1.424 0-0.57-0.19-1.044-0.601-1.393-0.38-0.38-0.886-0.57-1.424-0.57z"></path>
<path class="path11" d="M94.038 9.274h-3.197v3.513h-1.867v2.975h1.867v5.381c0 1.678 0.348 2.88 1.013 3.577s1.836 1.044 3.513 1.044c0.538 0 1.076-0.032 1.583-0.063h0.158v-2.975l-1.108 0.063c-0.791 0-1.298-0.127-1.551-0.411s-0.38-0.855-0.38-1.709v-4.906h3.039v-2.975h-3.039v-3.513z"></path>
<path class="path12" d="M112.364 7.343h3.26v18.39h-3.26v-18.39z"></path>
<path class="path13" d="M148.574 21.112c-0.57 0.665-1.171 1.234-1.646 1.519v0c-0.443 0.285-1.013 0.443-1.678 0.443-0.95 0-1.741-0.348-2.374-1.076s-0.95-1.646-0.95-2.754 0.317-2.026 0.918-2.722c0.633-0.728 1.393-1.076 2.342-1.076 1.044 0 2.152 0.665 3.102 1.773l2.152-2.057c-1.393-1.836-3.197-2.69-5.349-2.69-1.804 0-3.355 0.665-4.621 1.931s-1.899 2.912-1.899 4.843 0.633 3.545 1.899 4.843c1.266 1.298 2.817 1.931 4.621 1.931 2.374 0 4.273-1.013 5.539-2.88l-2.057-2.026z"></path>
<path class="path14" d="M161.962 14.591c-0.475-0.633-1.108-1.171-1.867-1.551-0.791-0.38-1.678-0.57-2.69-0.57-1.836 0-3.323 0.665-4.431 1.994-1.076 1.329-1.646 2.944-1.646 4.874 0 1.962 0.601 3.577 1.804 4.843 1.171 1.234 2.785 1.867 4.716 1.867 2.184 0 4.020-0.886 5.349-2.659l0.063-0.095-2.121-2.057c-0.19 0.253-0.475 0.506-0.728 0.76-0.317 0.317-0.633 0.538-0.95 0.696-0.475 0.253-1.044 0.348-1.646 0.348-0.918 0-1.646-0.253-2.216-0.791-0.538-0.475-0.855-1.139-0.918-1.962h8.641l0.032-1.203c0-0.855-0.127-1.646-0.348-2.406-0.222-0.728-0.57-1.456-1.044-2.089zM154.841 17.63c0.158-0.633 0.443-1.139 0.855-1.551 0.443-0.443 1.013-0.665 1.709-0.665 0.791 0 1.393 0.222 1.804 0.665 0.38 0.411 0.601 0.918 0.665 1.519h-5.033z"></path>
<path class="path15" d="M174.497 13.737v0c-0.981-0.855-2.342-1.266-4.051-1.266-1.076 0-2.089 0.253-3.007 0.696-0.855 0.443-1.678 1.139-2.216 2.089l0.032 0.032 2.089 1.994c0.855-1.361 1.804-1.836 3.070-1.836 0.696 0 1.234 0.19 1.678 0.538s0.633 0.823 0.633 1.393v0.633c-0.823-0.253-1.614-0.38-2.406-0.38-1.614 0-2.944 0.38-3.925 1.139s-1.488 1.867-1.488 3.229c0 1.203 0.411 2.216 1.266 2.944 0.855 0.696 1.899 1.076 3.134 1.076s2.406-0.506 3.45-1.361v1.076h3.197v-8.324c0.063-1.583-0.443-2.817-1.456-3.672zM168.704 20.795c0.38-0.253 0.886-0.38 1.551-0.38 0.791 0 1.614 0.158 2.469 0.475v1.266c-0.696 0.665-1.646 0.981-2.817 0.981-0.57 0-1.013-0.127-1.298-0.38s-0.443-0.538-0.443-0.95c0-0.443 0.19-0.76 0.538-1.013z"></path>
<path class="path16" d="M188.55 13.99c-0.918-1.013-2.184-1.519-3.798-1.519-1.298 0-2.342 0.38-3.134 1.108v-0.791h-3.197v12.977h3.26v-7.185c0-0.981 0.222-1.773 0.696-2.311 0.475-0.57 1.076-0.823 1.931-0.823 0.728 0 1.298 0.253 1.709 0.728 0.411 0.506 0.633 1.171 0.633 2.026v7.501h3.26v-7.47c0-1.804-0.443-3.229-1.361-4.241z"></path>
<path class="path17" d="M108.281 13.737v0c-0.981-0.855-2.342-1.266-4.051-1.266-1.076 0-2.089 0.253-3.007 0.696-0.855 0.443-1.678 1.139-2.216 2.089l0.032 0.032 2.089 1.994c0.855-1.361 1.804-1.836 3.070-1.836 0.696 0 1.234 0.19 1.678 0.538s0.633 0.823 0.633 1.393v0.633c-0.823-0.253-1.614-0.38-2.406-0.38-1.614 0-2.944 0.38-3.925 1.139s-1.488 1.867-1.488 3.229c0 1.203 0.411 2.216 1.266 2.944 0.855 0.696 1.899 1.076 3.134 1.076s2.406-0.506 3.45-1.361v1.076h3.197v-8.324c0.032-1.583-0.475-2.817-1.456-3.672zM102.489 20.795c0.38-0.253 0.886-0.38 1.551-0.38 0.791 0 1.614 0.158 2.469 0.475v1.266c-0.696 0.665-1.646 0.981-2.817 0.981-0.57 0-1.013-0.127-1.298-0.38s-0.443-0.538-0.443-0.95c0-0.443 0.158-0.76 0.538-1.013z"></path>
<path class="path18" d="M127.462 26.018c-5.223 0-9.496-4.241-9.496-9.496s4.241-9.496 9.496-9.496 9.496 4.241 9.496 9.496-4.273 9.496-9.496 9.496zM127.462 10.382c-3.387 0-6.14 2.754-6.14 6.14s2.754 6.14 6.14 6.14 6.14-2.754 6.14-6.14-2.754-6.14-6.14-6.14z"></path>
</svg>

          <span class="sr-only">DigitalOcean</span>
</a>
        <span class="logo-separator"></span>

        <a class="home-link" href="https://www.digitalocean.com/community">
          <span class="logo-community-text">Community</span>
</a>      </div>

      <a class="mobile-nav-toggle icon-menu-thin" data-role="left">
        <span>Menu</span>
      </a>

      
<nav>

  <ul>
    <li><a class="active" href="https://www.digitalocean.com/community/tutorials">Tutorials</a></li>
    <li><a href="https://www.digitalocean.com/community/questions">Questions</a></li>
    <li><a href="https://www.digitalocean.com/community/projects">Projects</a></li>
    <li><a href="https://www.meetup.com/pro/digitalocean/?utm_source=do_community" target="_blank">Meetups</a></li>
    <li class="mobile-nav-only"><a href="https://www.digitalocean.com/">Main Site</a></li>
  </ul>
</nav>


      
<div class="account-buttons">
    <div id="entrance">
      <a id="sign-up" class="button" href="https://www.digitalocean.com/community/auth/digitalocean?display=sessionless+register">Sign Up</a>
      <a id="log-in" class="button" href="https://www.digitalocean.com/community/auth/digitalocean">Log In</a>
    </div>
</div>
      <div class="header-search open">
  <form action="https://www.digitalocean.com/community/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="✓">
    <span class="icon icon-search-thin"></span>
    <input type="text" name="q" id="q" title="Search" placeholder="Search" autocomplete="off" spellcheck="false" class="header-search__input" data-algolia-application-id="6ZHEUVKJ88" data-algolia-api-key="c5470567eae7fa1177d43222e18ba086">
    <button name="button" type="submit" class="icon-btn">submit</button>
</form></div>

<div class="search-results-dropdown dropdown" data-root-path="https://www.digitalocean.com/community">
  <div class="container">
    <div class="header-search-results-list"></div>

    <div id="btn-wrap">
      <a class="more-search-results" data-search-path="/community/search" href="https://www.digitalocean.com/community/search">
        <span class="icon-mag"></span>
        View All Results
</a>    </div>
  </div>
</div>

<script type="text/template" id="autocomplete-hits-template">
  <div class="inner-search">
    <ul>
        {{#hits}}
          <li>
            <span class='icon icon-{{type}}'></span>
            <a href='{{url}}'>{{title}}</a>
          </li>
        {{/hits}}
    </ul>
  </div>
</script>


      <div class="clearfix"></div>
    </div>
  </div>

  <div class="wrapper">
    
  </div>
</header>


      

      <div class="wrapper layout-wrapper">

        









<div class="section-content section-content-growable content Tutorial-content">
  <div class="postable-info-bar-container">
  <div class="postable-info-bar">
    <div class="left-section">
      
      
    </div>

    <div class="right-section">
      


      <div class="section-item section-item-subscribe">
  <span class="opt-in-switch off signed-out-subscribe">
    <span class="subscribe-label">
      <span class="icon icon-subscribe"></span>
      <span class="subscription-label subscribe">Subscribe</span>
      <span class="icon icon-subscribed"></span>
      <span class="subscription-label subscribed">Subscribed</span>
    </span>
    <a data-toggle="modal" data-target="#sign-in-modal" class="mini-switch-container" href="javascript:void(0);"><div class="mini-switch off signed-out-subscribe"><div class="switch-handle"></div></div></a>
  </span>
</div>

<div class="section-item social-sharing-item">
  <div class="sharing">
  <a class="share-button" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6#" data-toggle="modal" data-target="#share-modal">
    <span class="icon icon-share-square"></span>
    <span class="share-button-text">Share</span>
  </a>
</div>

</div>

        <div class="section-item table-of-contents-triggers"><div class="toc-trigger-mobile" data-toggle="modal" data-target="#contents-modal">
  <a href="javascript:void(0);">
    <span class="icon icon-contents"></span>
    <span class="title">Contents</span>
    <span class="icon icon-arrow-down"></span>
  </a>
</div>

</div>

    </div>
  </div>
</div>



  <div class="container tutorial-header">

      <div class="info-cta">
    <a class="icon-close-light" href="javascript:void();"></a>
    We hope you find this tutorial helpful. In addition to guides like this one, we provide simple cloud infrastructure for developers. <a href="https://www.digitalocean.com/?utm_medium=community&amp;utm_source=community_gencta&amp;utm_campaign=needaserver&amp;utm_content=how-to-set-up-a-basic-iptables-firewall-on-centos-6">
        Learn more →
</a>  </div>


    <button name="button" type="button" class="new-upvote-button" data-include-caret="true" data-upvotable-id="245" data-upvotable-type="Tutorial"><span class="icon new-upvote-icon"><svg class="svg-icon svg-icon-upvote-empty"><use xlink:href="https://www.digitalocean.com/assets/community/icon-sprite-d76eb75d70ccf8ffb4c0b47b7dbc88ca.svg#icon-upvote-empty"></use></svg></span><span class="new-upvote-count">37</span></button>

    <h1 class="content-title Tutorial-header">
      <button type="button" class="Button--reset Tutorial-headerButton " data-toggle="tooltip" title="" data-js="markAsComplete" data-tutorialinteraction="" data-tutorialsingle="" data-original-title="Mark as Complete">
        <svg class="svg-icon svg-icon-completed"><use xlink:href="https://www.digitalocean.com/assets/community/icon-sprite-d76eb75d70ccf8ffb4c0b47b7dbc88ca.svg#icon-completed"></use></svg>
      </button> How To Set Up a Basic Iptables Firewall on Centos 6
    </h1>

    <span class="meta-section timestamp"><span class="tutorial-date-text">Posted</span><span class="tutorial-date">April 16, 2013</span></span>

    <span class="meta-section pageviews"><span class="icon icon-eye v-mid"></span><span class="views-count v-mid">727.1k</span><span class="sr-only"> views</span></span>

    <span class="meta-section tags">
      <a class="tag" href="https://www.digitalocean.com/community/tags/firewall?type=tutorials">Firewall</a> <a class="tag" href="https://www.digitalocean.com/community/tags/security?type=tutorials">Security</a>
      <a class="tag" href="https://www.digitalocean.com/community/tags/centos?type=tutorials">CentOS</a>
    </span>
  </div>

    <div class="content-body tutorial-content tutorial-content-legacy" data-growable-markdown="">
      <div><h3>Intro</h3>

<p>This article will show how to create a simple firewall on a Centos VPS. It will only open up ports that we want and close up other services. I will also show how to prevent simpler attacks, and how to let yourself back in to the VPS if you deny access to yourself by accident.</p>

<p>The tutorial is not by any means exhaustive and only shows how to open up a few incoming ports: for apache, SSH and email and close all the others. We will not be blocking any outgoing traffic, and only create a few most common rules to block the usual scripts and bots that look for vulnerable VPS.</p>

<p><strong>iptables</strong> is a simple firewall installed on most linux distributions. The linux <a href="http://ipset.netfilter.org/iptables.man.html">manual page</a> for <em>iptables</em> says it is an <em>administration tool for IPv4 packet filtering and NAT</em>, which, in translation, means it is a tool to filter out and block Internet traffic. <strong>iptables</strong> firewall is included by default in Centos 6.4 linux images provided by DigitalOcean.</p>

<p>We will set up firewall one by one rule. To simplify: a firewall is a list of <em>rules</em>, so when an incomming connection is open, if it matches any of the rules, this rule can accept that connection or reject it. If no rules are met, we use the default rule.</p>

<p><b>Note:</b> <i>This tutorial covers IPv4 security. In Linux, IPv6 security is maintained separately from IPv4. For example, "iptables" only maintains firewall rules for IPv4 addresses but it has an IPv6 counterpart called "ip6tables", which can be used to maintain firewall rules for IPv6 network addresses.</i></p>

<p><i>If your VPS is configured for IPv6, please remember to secure both your IPv4 and IPv6 network interfaces with the appropriate tools. For more information about IPv6 tools, refer to this guide: <a href="https://www.digitalocean.com/community/tutorials/how-to-configure-tools-to-use-ipv6-on-a-linux-vps">How To Configure Tools to Use IPv6 on a Linux VPS</a></i></p>

<div name="decide-which-ports-and-services-to-open" data-unique="decide-which-ports-and-services-to-open"></div><h2>Decide which ports and services to open</h2>

<p>To start with, we want to know what services we want to open to public. Let's use the typical web-hosting server: it is a web and email server, and we also need to let ourselves in by SSH server.</p>

<p>First, we want to leave SSH port open so we can connect to the VPS remotely: that is port 22.</p>

<p>Also, we need port 80 and 443 (SSL port) for web traffic. For sending email, we will open port 25 (regular SMTP) and 465 (secure SMTP). To let users receive email, we will open the usual port 110 (POP3) and 995 (secure POP3 port).</p>

<p>Additionally, we'll open IMAP ports, if we have it installed: 143 for IMAP, and 993 for IMAP over SSL.Note: <em>It is recommended to only allow secure protocols, but that may not be an option, if we cannot influence the mail service users to change their email clients.</em></p>

<div name="block-the-most-common-attacks" data-unique="block-the-most-common-attacks"></div><h2>Block the most common attacks</h2>

<p>DigitalOcean VPSs usually come with the empty configuration: all traffic is allowed. Just to make sure of this, we can <em>flush</em> the firewall rules - that is, erase them all:</p>

<pre>iptables -F</pre>

<p>We can then add a few simple firewall rules to block the most common attacks, to protect our VPS from script-kiddies. We can't really count on iptables alone to protect us from a full-scale DDOS or similar, but we can at least put off the usual network scanning bots that will eventually find our VPS and start looking for security holes to exploit. First, we start with blocking null packets.</p>

<pre>iptables -A INPUT -p tcp --tcp-flags ALL NONE -j DROP</pre>

<p>We told the firewall to take all incoming packets with tcp flags NONE and just DROP them. <a href="http://minsky.gsi.dit.upm.es/semanticwiki/index.php/TCP_Null_Scan">Null packets</a> are, simply said, recon packets. The attack patterns use these to try and see how we configured the VPS and find out weaknesses. The next pattern to reject is a syn-flood attack.</p>

<pre>iptables -A INPUT -p tcp ! --syn -m state --state NEW -j DROP</pre>

<p><a href="http://en.wikipedia.org/wiki/Syn-flood">Syn-flood attack</a> means that the attackers open a new connection, but do not state what they want (ie. SYN, ACK, whatever). They just want to take up our servers' resources. We won't accept such packages. Now we move on to one more common pattern: <a href="http://en.wikipedia.org/wiki/Christmas_tree_packet">XMAS</a> packets, also a recon packet.</p> 

<pre>iptables -A INPUT -p tcp --tcp-flags ALL ALL -j DROP</pre>

<p>We have ruled out at least some of the usual patterns that find vulnerabilities in our VPS.</p>

<div name="open-up-ports-for-selected-services" data-unique="open-up-ports-for-selected-services"></div><h2>Open up ports for selected services</h2>

<p>Now we can start adding selected services to our firewall filter. The first such thing is a localhost interface:</p>

<pre>iptables -A INPUT -i lo -j ACCEPT</pre>

<p>We tell iptables to add (-A) a rule to the incoming (INPUT) filter table any trafic that comes to localhost interface (-i lo) and to accept (-j ACCEPT) it. Localhost is often used for, ie. your website or email server communicating with a database locally installed. That way our VPS can use the database, but the database is closed to exploits from the internet.</p> 

<p>Now we can allow web server traffic:</p>

<pre>iptables -A INPUT -p tcp -m tcp --dport 80 -j ACCEPT
iptables -A INPUT -p tcp -m tcp --dport 443 -j ACCEPT</pre>
We added the two ports (http port 80, and https port 443) to the ACCEPT chain - allowing traffic in on those ports. Now, let's allow users use our SMTP servers:
<pre>iptables -A INPUT -p tcp -m tcp --dport 25 -j ACCEPT
iptables -A INPUT -p tcp -m tcp --dport 465 -j ACCEPT</pre>

<p>Like stated before, if we can influence our users, we should rather use the secure version, but often we can't dictate the terms and the clients will connect using port 25, which is much more easier to have passwords sniffed from. We now proceed to allow the users read email on their server:</p>

<pre>iptables -A INPUT -p tcp -m tcp --dport 110 -j ACCEPT
iptables -A INPUT -p tcp -m tcp --dport 995 -j ACCEPT</pre>

<p>Those two rules will allow POP3 traffic. Again, we could increase security of our email server by just using the secure version of the service. Now we also need to allow IMAP mail protocol:</p>

<pre>iptables -A INPUT -p tcp -m tcp --dport 143 -j ACCEPT
iptables -A INPUT -p tcp -m tcp --dport 993 -j ACCEPT</pre>

<div name="limiting-ssh-access" data-unique="limiting-ssh-access"></div><h2>Limiting SSH access</h2>

<p>We should also allow SSH traffic, so we can connect to the VPS remotely. The simple way to do it would be with this command:</p>

<pre>iptables -A INPUT -p tcp -m tcp --dport 22 -j ACCEPT</pre>

<p>We now told iptables to add a rule for accepting <em>tcp</em> traffic incomming to port 22 (the default SSH port). It is advised to change the SSH configuration to a different port, and this firewall filter should be changed accordingly, but configuring SSH is not a part of this article.</p>

<p>However, we could do one more thing about that with firewall itself. If our office has a permanent IP address, we could only allow connections to SSH from this source. This would allow only people from our location to connect.</p>

<p>First, find out your outside IP address. Make sure it is not an address from your LAN, or it will not work. You could do that simply by visiting the <a href="http://whatismyip.org/">whatismyip.com</a> site. Another way to find it out is to type:</p>

<pre>w</pre>

<p>in the terminal, we should see us logged in (if we're the only one logged in' and our IP address written down.</p>

<p>The output looks something like this:</p>

<pre>root@iptables# w
 11:42:59 up 60 days, 11:21,  1 user,  load average: 0.00, 0.00, 0.00
USER     TTY      FROM              LOGIN@   IDLE   JCPU   PCPU WHAT
root   pts/0    213.191.xxx.xxx  09:27    0.00s  0.05s  0.00s w
</pre>

<p>Now, you can create the firewall rule to only allow traffic to SSH port if it comes from one source: your IP address:</p>

<pre>iptables -A INPUT -p tcp -s YOUR_IP_ADDRESS -m tcp --dport 22 -j ACCEPT</pre>

<p>Replace YOUR_IP_ADDRESS with the actuall IP, of course.</p>

<p>We could open more ports on our firewall as needed by changing the port numbers. That way our firewall will allow access only to services we want. Right now, we need to add one more rule that will allow us to use outgoing connections (ie. ping from VPS or run software updates);</p>

<pre>iptables -I INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT</pre>

<p>It will allow any established outgoing connections to receive replies from the VPS on the other side of that connection.
When we have it all set up, we will block everything else, and allow all outgoing connections.</p>

<pre>iptables -P OUTPUT ACCEPT
iptables -P INPUT DROP</pre>

<p>Now we have our firewall rules in place.</p>

<div name="save-the-configuration" data-unique="save-the-configuration"></div><h2>Save the configuration</h2>

<p>Now that we have all the configuration in, we can list the rules to see if anything is missing.</p>

<pre>iptables -L -n</pre>

<p>The <strong>-n</strong> switch here is because we need only ip addresses, not domain names. Ie. if there is an IP in the rules like this: 69.55.48.33: the firewall would go look it up and see that it was a digitalocean.com IP. We don't need that, just the address itself. Now we can finally save our firewall configuration:</p>

<pre>iptables-save | sudo tee /etc/sysconfig/iptables</pre>

<p>The <em>iptables</em> configuration file on CentOS is located at <em>/etc/sysconfig/iptables</em>. The above command saved the rules we created into that file. Just to make sure everything works, we can restart the firewall:</p>

<pre>service iptables restart</pre>

<p>The saved rules will persist even when the VPS is rebooted.</p>

<div name="flush-to-unlock-yourself" data-unique="flush-to-unlock-yourself"></div><h2>Flush to unlock yourself</h2>

<p>If we made an accident in our configuration, we may have blocked ourselves from accessing the VPS. Perhaps we have put in the incorrect IP address so the firewall does not allow connections from our workstation. Now we can't reach those rules, and if we saved them, even a restart won't help us. Luckily, the DO web interface allowes us to connect to server via console:</p>

<img src="./How To Set Up a Basic Iptables Firewall on Centos 6 _ DigitalOcean_files/IDnXako.png" alt="Console">

<p>Once connected, we log in as root and issue the following command:</p>

<pre>iptables -F</pre>

<p>This will flush the filters, we'll be able to get in the VPS again.</p>

<div name="conclusion" data-unique="conclusion"></div><h2>Conclusion</h2>

<p>This article is not exhaustive, and it only scratched the surface of running a simple firewall on a linux machine. It will do enough for a typical web and email server scenario for a developer not familiar with linux command line or iptables.</p>
 
<p>However, a lot more could be done. There are good tutorials and samples on the internet to help us provide more robust configuration. For production environments, it would be advised to create a more detailed configuration or to have a security expert prepare the configuration.</p>

<p>Hopefully, the short instructions will provide basic security to new VPSs.</p></div>
    </div>
</div>

<div class="tutorial-footer">
  <div class="tutorial-footer-details">

  <div class="postable-info-bar-container">
  <div class="postable-info-bar">
    <div class="left-section">
      
    </div>
    <div class="right-section">
      <div class="upvote-container">
        <button name="button" type="button" class="new-upvote-button" data-include-caret="false" data-upvotable-id="245" data-upvotable-type="Tutorial"><span class="icon new-upvote-icon"><svg class="svg-icon svg-icon-heart"><use xlink:href="https://www.digitalocean.com/assets/community/icon-sprite-d76eb75d70ccf8ffb4c0b47b7dbc88ca.svg#icon-heart"></use></svg></span><span class="new-upvote-text">Upvote</span><span class="new-upvote-count">37</span></button>
      </div>
      <div class="section-item section-item-subscribe">
  <span class="opt-in-switch off signed-out-subscribe">
    <span class="subscribe-label">
      <span class="icon icon-subscribe"></span>
      <span class="subscription-label subscribe">Subscribe</span>
      <span class="icon icon-subscribed"></span>
      <span class="subscription-label subscribed">Subscribed</span>
    </span>
    <a data-toggle="modal" data-target="#sign-in-modal" class="mini-switch-container" href="javascript:void(0);"><div class="mini-switch off signed-out-subscribe"><div class="switch-handle"></div></div></a>
  </span>
</div>

<div class="section-item social-sharing-item">
  <div class="sharing">
  <a class="share-button" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6#" data-toggle="modal" data-target="#share-modal">
    <span class="icon icon-share-square"></span>
    <span class="share-button-text">Share</span>
  </a>
</div>

</div>

    </div>
  </div>
</div>


  <div class="section-content tutorial-contributors zero">


  </div>
</div>


  
  <div class="tutorial-ctas" style="background-image:url(https://assets.digitalocean.com/labs/btp/objectstorage.png), linear-gradient(to right, #04338b, #040434);  background-position:bottom center; padding-top:-10px;">
  <div class="section-content">
    <div class="cta-description">
      <h2 style="color: rgb(255, 255, 255);">Introducing Spaces: Object Storage on DigitalOcean</h2>

      <p style="color: rgb(255, 255, 255); padding: 15px 0px; line-height: 1.3em;">A simple and cost-effective way to store, serve, backup, and archive a virtually infinite amount of media, content, images, and static files for your apps.</p>

      <a class="cloud-tutorial-cta" href="https://cloud.digitalocean.com/spaces?utm_source=comm_exp&amp;utm_medium=btp_customers_objectstorage" style="background:#FFF;color:#0069FF;">Try free for 2 months</a>
    </div>
  </div>
</div>
    <div class="related-tutorials">
    <div class="section-content">
      <h2>Related Tutorials</h2>

      <ul>
        <li><a class="related-link" href="https://www.digitalocean.com/community/tutorials/how-to-migrate-iptables-firewall-rules-to-a-new-server">How To Migrate Iptables Firewall Rules to a New Server</a></li>
<li><a class="related-link" href="https://www.digitalocean.com/community/tutorials/how-to-secure-web-server-infrastructure-with-digitalocean-cloud-firewalls-using-doctl">How To Secure Web Server Infrastructure With DigitalOcean Cloud Firewalls Using Doctl</a></li>
<li><a class="related-link" href="https://www.digitalocean.com/community/tutorials/how-to-troubleshoot-digitalocean-firewalls">How To Troubleshoot DigitalOcean Firewalls</a></li>
<li><a class="related-link" href="https://www.digitalocean.com/community/tutorials/an-introduction-to-digitalocean-cloud-firewalls">An Introduction To DigitalOcean Cloud Firewalls</a></li>
<li><a class="related-link" href="https://www.digitalocean.com/community/tutorials/how-to-create-your-first-digitalocean-cloud-firewall">How To Create Your First DigitalOcean Cloud Firewall</a></li>

      </ul>
    </div>
  </div>

</div>

<div class="content-comments">
  <div class="section-content">
    <div class="tutorial commentable" id="tutorial_245">

  <div class="comments-header">
    <h4 class="comments-count"><span>87 Comments</span></h4>
  </div>

  <div class="response response-form no-avatar">
  <div class="js-display-on-error flash error hidden"></div>


  <form class="content-form disabled-form" id="new_comment" action="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6/comments" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="✓" disabled="disabled">

    <div class="meltdown_wrap" style="height: auto;"><div class="meltdown_topmargin"></div><div class="meltdown_bar"><ul class="meltdown_controls meltdown_controls_preview"><li class="meltdown_control-preview meltdown_control meltdown_controlbutton disabled" title="" data-original-title="Toggle Preview"><span>Preview</span></li></ul><div class="preview-header">Markdown Preview</div><ul class="meltdown_controls meltdown_controls_main"><li class="meltdown_control-bold meltdown_control meltdown_controlbutton disabled" title="" data-original-title="Bold"><span unselectable="on">B</span></li><li class="meltdown_control-italics meltdown_control meltdown_controlbutton disabled" title="" data-original-title="Italics"><span unselectable="on">I</span></li><li class="meltdown_control-h1 meltdown_control meltdown_controlbutton disabled" title="" data-original-title="Header 1"><span unselectable="on">H1</span></li><li class="meltdown_control-h2 meltdown_control meltdown_controlbutton disabled" title="" data-original-title="Header 2"><span unselectable="on">H2</span></li><li class="meltdown_control-h3 meltdown_control meltdown_controlbutton disabled" title="" data-original-title="Header 3"><span unselectable="on">H3</span></li><li class="meltdown_control-ul meltdown_control meltdown_controlbutton disabled" title="" data-original-title="Unordered List"><span unselectable="on">UL</span></li><li class="meltdown_control-ol meltdown_control meltdown_controlbutton disabled" title="" data-original-title="Ordered List"><span unselectable="on">OL</span></li><li class="meltdown_control-link meltdown_control meltdown_controlbutton disabled" title="" data-original-title="Link"><span unselectable="on">Link</span></li><li class="meltdown_control-code meltdown_control meltdown_controlbutton disabled" title="" data-original-title="Code"><span unselectable="on">Code</span></li><li class="meltdown_control-highlight meltdown_control meltdown_controlbutton disabled" title="" data-original-title="Highlight"><span unselectable="on">Highlight</span></li><li class="meltdown_control-table meltdown_control meltdown_controlbutton disabled" title="" data-original-title="Table"><span unselectable="on">Table</span></li></ul></div><div class="meltdown_editor-wrap"><div class="meltdown_editor-deco"><textarea name="comment[content]" id="comment_content" placeholder="Leave a comment..." class="js-comment-content tutorial-comment-field meltdown_editor" data-markdown="true" disabled="disabled" style="overflow: hidden; word-wrap: break-word; resize: none; height: 120px;"></textarea></div></div><div class="meltdown_preview-wrap"><div class="meltdown_preview-wrap2"><div class="meltdown_preview-error-message">Could not load preview. <a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6#">Try again</a></div><div class="meltdown_preview-loading-message">Loading preview...</div><div class="meltdown_preview content-body"></div></div></div><div class="meltdown_bottommargin"></div></div>

      <div class="log-in-notice "><a href="https://www.digitalocean.com/community/auth/digitalocean">Log In to Comment</a></div>

    <div class="clearfix"></div>
</form>
</div>


  <div class="comments">
    <ul class="response-list">
          <a class="hidden" rel="nofollow" data-remote="true" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6/comments">Load</a>
    <li id="comment_1409" data-level="0" class="comment-container">
    <div class="response comment-body-container    " data-highlight="">
      <div class="comment-upvote-container ">
        <button name="button" type="button" class="new-upvote-button" data-include-caret="true" data-upvotable-id="1409" data-upvotable-type="Comment"><span class="icon new-upvote-icon"><svg class="svg-icon svg-icon-upvote-empty"><use xlink:href="https://www.digitalocean.com/assets/community/icon-sprite-d76eb75d70ccf8ffb4c0b47b7dbc88ca.svg#icon-upvote-empty"></use></svg></span><span class="new-upvote-count">0</span></button>
      </div>
      <div class="ox-auto">
        <div class="comment-header">
          <span class="response-name"><a class="username" href="https://www.digitalocean.com/community/users/dennisk">dennisk</a></span>
          
          <span class="response-time"><a rel="nofollow" class="post-time-link" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6?comment=1409">April 29, 2013</a></span>

          
        </div>

          <div class="response-body content-body">
            <div class="legacy">If I want to forward port 80 to 8080 for a webserver listening on 8080, how would I do that in this table?</div>
            
          </div>

        

        <div class="spinner spinner-large">
  <div class="bounce1"></div>
  <div class="bounce2"></div>
  <div class="bounce3"></div>
  
</div>


        <div class="content-actions">
  <div class="comment-actions">

    

    
  </div>

  <div class="comment-moderation-actions">
    <ul class="comment-moderation-actions-list ">
      







    </ul>
  </div>
</div>

      </div>
      <div class="clear"></div>
    </div>
    <div class="response-comments">
      <div class="response_comment commentable comment" id="response_comment_1409">


  <div class="comments">
    <ul class="response-list">
      



    </ul>
  </div>


  <div id="reply_anchor_comment_1409"></div>
</div>
    </div>

  </li>

      <li id="comment_2023" data-level="0" class="comment-container">
    <div class="response comment-body-container    " data-highlight="">
      <div class="comment-upvote-container ">
        <button name="button" type="button" class="new-upvote-button" data-include-caret="true" data-upvotable-id="2023" data-upvotable-type="Comment"><span class="icon new-upvote-icon"><svg class="svg-icon svg-icon-upvote-empty"><use xlink:href="https://www.digitalocean.com/assets/community/icon-sprite-d76eb75d70ccf8ffb4c0b47b7dbc88ca.svg#icon-upvote-empty"></use></svg></span><span class="new-upvote-count">0</span></button>
      </div>
      <div class="ox-auto">
        <div class="comment-header">
          <span class="response-name"><a class="username" href="https://www.digitalocean.com/community/users/kushal-red">kushal.red</a></span>
          
          <span class="response-time"><a rel="nofollow" class="post-time-link" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6?comment=2023">June  4, 2013</a></span>

          
        </div>

          <div class="response-body content-body">
            <div class="legacy">iptables -A PREROUTING -t nat -i eth1 -p tcp --dport 80 -j REDIRECT --to-port 8080

use this....</div>
            
          </div>

        

        <div class="spinner spinner-large">
  <div class="bounce1"></div>
  <div class="bounce2"></div>
  <div class="bounce3"></div>
  
</div>


        <div class="content-actions">
  <div class="comment-actions">

    

    
  </div>

  <div class="comment-moderation-actions">
    <ul class="comment-moderation-actions-list ">
      







    </ul>
  </div>
</div>

      </div>
      <div class="clear"></div>
    </div>
    <div class="response-comments">
      <div class="response_comment commentable comment" id="response_comment_2023">


  <div class="comments">
    <ul class="response-list">
      



    </ul>
  </div>


  <div id="reply_anchor_comment_2023"></div>
</div>
    </div>

  </li>

      <li id="comment_2186" data-level="0" class="comment-container">
    <div class="response comment-body-container    " data-highlight="">
      <div class="comment-upvote-container ">
        <button name="button" type="button" class="new-upvote-button" data-include-caret="true" data-upvotable-id="2186" data-upvotable-type="Comment"><span class="icon new-upvote-icon"><svg class="svg-icon svg-icon-upvote-empty"><use xlink:href="https://www.digitalocean.com/assets/community/icon-sprite-d76eb75d70ccf8ffb4c0b47b7dbc88ca.svg#icon-upvote-empty"></use></svg></span><span class="new-upvote-count">0</span></button>
      </div>
      <div class="ox-auto">
        <div class="comment-header">
          <span class="response-name"><a class="username" href="https://www.digitalocean.com/community/users/business">business</a></span>
          
          <span class="response-time"><a rel="nofollow" class="post-time-link" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6?comment=2186">June 15, 2013</a></span>

          
        </div>

          <div class="response-body content-body">
            <div class="legacy">I tried using 

'sudo iptables-save &gt; /etc/sysconfig/iptables' 

while logged in as superuser I created with all permissions, but got a permission denied. Did a little research and used the following command to save the configurations

'sudo /etc/init.d/iptables save' on CentOS

Additionally for Debian/Ubuntu I believe the command is

sudo vi /etc/network/interfaces
</div>
            
          </div>

        

        <div class="spinner spinner-large">
  <div class="bounce1"></div>
  <div class="bounce2"></div>
  <div class="bounce3"></div>
  
</div>


        <div class="content-actions">
  <div class="comment-actions">

    

    
  </div>

  <div class="comment-moderation-actions">
    <ul class="comment-moderation-actions-list ">
      







    </ul>
  </div>
</div>

      </div>
      <div class="clear"></div>
    </div>
    <div class="response-comments">
      <div class="response_comment commentable comment" id="response_comment_2186">


  <div class="comments">
    <ul class="response-list">
      



    </ul>
  </div>


  <div id="reply_anchor_comment_2186"></div>
</div>
    </div>

  </li>

      <li id="comment_2256" data-level="0" class="comment-container">
    <div class="response comment-body-container    " data-highlight="">
      <div class="comment-upvote-container ">
        <button name="button" type="button" class="new-upvote-button" data-include-caret="true" data-upvotable-id="2256" data-upvotable-type="Comment"><span class="icon new-upvote-icon"><svg class="svg-icon svg-icon-upvote-empty"><use xlink:href="https://www.digitalocean.com/assets/community/icon-sprite-d76eb75d70ccf8ffb4c0b47b7dbc88ca.svg#icon-upvote-empty"></use></svg></span><span class="new-upvote-count">0</span></button>
      </div>
      <div class="ox-auto">
        <div class="comment-header">
          <span class="response-name"><a class="username" href="https://www.digitalocean.com/community/users/webmaster78927">webmaster78927</a></span>
          
          <span class="response-time"><a rel="nofollow" class="post-time-link" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6?comment=2256">June 21, 2013</a></span>

          
        </div>

          <div class="response-body content-body">
            <div class="legacy">If I want to use postfix on my server to relay SMTP to gmail (i.e. send email from my server via gmail) ONLY, do I need any iptables rules?  Right now, things are locked down to standard HTTP and SSH ports and that's it.  Not sure if I need to open up other ports to allow the relay.</div>
            
          </div>

        

        <div class="spinner spinner-large">
  <div class="bounce1"></div>
  <div class="bounce2"></div>
  <div class="bounce3"></div>
  
</div>


        <div class="content-actions">
  <div class="comment-actions">

    

    
  </div>

  <div class="comment-moderation-actions">
    <ul class="comment-moderation-actions-list ">
      







    </ul>
  </div>
</div>

      </div>
      <div class="clear"></div>
    </div>
    <div class="response-comments">
      <div class="response_comment commentable comment" id="response_comment_2256">


  <div class="comments">
    <ul class="response-list">
      



    </ul>
  </div>


  <div id="reply_anchor_comment_2256"></div>
</div>
    </div>

  </li>

      <li id="comment_2270" data-level="0" class="comment-container">
    <div class="response comment-body-container    " data-highlight="">
      <div class="comment-upvote-container ">
        <button name="button" type="button" class="new-upvote-button" data-include-caret="true" data-upvotable-id="2270" data-upvotable-type="Comment"><span class="icon new-upvote-icon"><svg class="svg-icon svg-icon-upvote-empty"><use xlink:href="https://www.digitalocean.com/assets/community/icon-sprite-d76eb75d70ccf8ffb4c0b47b7dbc88ca.svg#icon-upvote-empty"></use></svg></span><span class="new-upvote-count">0</span></button>
      </div>
      <div class="ox-auto">
        <div class="comment-header">
          <span class="response-name"><a class="username" href="https://www.digitalocean.com/community/users/kamaln7">kamaln7</a></span>
          <span class="mod-badge">MOD</span>
          <span class="response-time"><a rel="nofollow" class="post-time-link" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6?comment=2270">June 22, 2013</a></span>

          
        </div>

          <div class="response-body content-body">
            <div class="legacy">@Mark: By default iptables does not block outgoing connections, but if it does not work for you, try adding this rule:

iptables -A OUTPUT -p tcp -m tcp --dport 25 -j ACCEPT</div>
            
          </div>

        

        <div class="spinner spinner-large">
  <div class="bounce1"></div>
  <div class="bounce2"></div>
  <div class="bounce3"></div>
  
</div>


        <div class="content-actions">
  <div class="comment-actions">

    

    
  </div>

  <div class="comment-moderation-actions">
    <ul class="comment-moderation-actions-list ">
      







    </ul>
  </div>
</div>

      </div>
      <div class="clear"></div>
    </div>
    <div class="response-comments">
      <div class="response_comment commentable comment" id="response_comment_2270">


  <div class="comments">
    <ul class="response-list">
      



    </ul>
  </div>


  <div id="reply_anchor_comment_2270"></div>
</div>
    </div>

  </li>

      <li id="comment_3403" data-level="0" class="comment-container">
    <div class="response comment-body-container    " data-highlight="">
      <div class="comment-upvote-container ">
        <button name="button" type="button" class="new-upvote-button" data-include-caret="true" data-upvotable-id="3403" data-upvotable-type="Comment"><span class="icon new-upvote-icon"><svg class="svg-icon svg-icon-upvote-empty"><use xlink:href="https://www.digitalocean.com/assets/community/icon-sprite-d76eb75d70ccf8ffb4c0b47b7dbc88ca.svg#icon-upvote-empty"></use></svg></span><span class="new-upvote-count">0</span></button>
      </div>
      <div class="ox-auto">
        <div class="comment-header">
          <span class="response-name"><a class="username" href="https://www.digitalocean.com/community/users/627elm">627elm</a></span>
          
          <span class="response-time"><a rel="nofollow" class="post-time-link" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6?comment=3403">August 11, 2013</a></span>

          
        </div>

          <div class="response-body content-body">
            <div class="legacy">Like Arunava, if I used the command to save the iptables suggested in the article, I too was denied permission. The Red Hat Enterprise 6 manual says to use "service iptables save" to save the iptables. I used this command and the system reported the rules were saved to /etc/sysconfig/iptables.
</div>
            
          </div>

        

        <div class="spinner spinner-large">
  <div class="bounce1"></div>
  <div class="bounce2"></div>
  <div class="bounce3"></div>
  
</div>


        <div class="content-actions">
  <div class="comment-actions">

    

    
  </div>

  <div class="comment-moderation-actions">
    <ul class="comment-moderation-actions-list ">
      







    </ul>
  </div>
</div>

      </div>
      <div class="clear"></div>
    </div>
    <div class="response-comments">
      <div class="response_comment commentable comment" id="response_comment_3403">


  <div class="comments">
    <ul class="response-list">
      



    </ul>
  </div>


  <div id="reply_anchor_comment_3403"></div>
</div>
    </div>

  </li>

      <li id="comment_3412" data-level="0" class="comment-container">
    <div class="response comment-body-container    " data-highlight="">
      <div class="comment-upvote-container ">
        <button name="button" type="button" class="new-upvote-button" data-include-caret="true" data-upvotable-id="3412" data-upvotable-type="Comment"><span class="icon new-upvote-icon"><svg class="svg-icon svg-icon-upvote-empty"><use xlink:href="https://www.digitalocean.com/assets/community/icon-sprite-d76eb75d70ccf8ffb4c0b47b7dbc88ca.svg#icon-upvote-empty"></use></svg></span><span class="new-upvote-count">0</span></button>
      </div>
      <div class="ox-auto">
        <div class="comment-header">
          <span class="response-name"><a class="username" href="https://www.digitalocean.com/community/users/kamaln7">kamaln7</a></span>
          <span class="mod-badge">MOD</span>
          <span class="response-time"><a rel="nofollow" class="post-time-link" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6?comment=3412">August 11, 2013</a></span>

          
        </div>

          <div class="response-body content-body">
            <div class="legacy">@nowaffles: I've updated the article. :]</div>
            
          </div>

        

        <div class="spinner spinner-large">
  <div class="bounce1"></div>
  <div class="bounce2"></div>
  <div class="bounce3"></div>
  
</div>


        <div class="content-actions">
  <div class="comment-actions">

    

    
  </div>

  <div class="comment-moderation-actions">
    <ul class="comment-moderation-actions-list ">
      







    </ul>
  </div>
</div>

      </div>
      <div class="clear"></div>
    </div>
    <div class="response-comments">
      <div class="response_comment commentable comment" id="response_comment_3412">


  <div class="comments">
    <ul class="response-list">
      



    </ul>
  </div>


  <div id="reply_anchor_comment_3412"></div>
</div>
    </div>

  </li>

      <li id="comment_4101" data-level="0" class="comment-container">
    <div class="response comment-body-container    " data-highlight="">
      <div class="comment-upvote-container ">
        <button name="button" type="button" class="new-upvote-button" data-include-caret="true" data-upvotable-id="4101" data-upvotable-type="Comment"><span class="icon new-upvote-icon"><svg class="svg-icon svg-icon-upvote-empty"><use xlink:href="https://www.digitalocean.com/assets/community/icon-sprite-d76eb75d70ccf8ffb4c0b47b7dbc88ca.svg#icon-upvote-empty"></use></svg></span><span class="new-upvote-count">0</span></button>
      </div>
      <div class="ox-auto">
        <div class="comment-header">
          <span class="response-name"><a class="username" href="https://www.digitalocean.com/community/users/timepiece">timepiece</a></span>
          
          <span class="response-time"><a rel="nofollow" class="post-time-link" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6?comment=4101">August 30, 2013</a></span>

          
        </div>

          <div class="response-body content-body">
            <div class="legacy">Hello. I create the bash script. Check please

iptables -F
iptables -X
iptables -t nat -F
iptables -t nat -X
iptables -t mangle -F
iptables -t mangle -X 


iptables -P INPUT DROP
iptables -P FORWARD ACCEPT
iptables -P OUTPUT ACCEPT

iptables -A INPUT -i lo -j ACCEPT

iptables -A INPUT -p tcp -m tcp --tcp-flags SYN,ACK,FIN,RST RST -m limit --limit 1/s -j ACCEPT

iptables -I INPUT -m conntrack --ctstate NEW,INVALID -p tcp --tcp-flags SYN,ACK SYN,ACK -j REJECT --reject-with tcp-reset

iptables -I INPUT -m conntrack --ctstate NEW -p tcp ! --syn -j DROP


iptables -I INPUT -p icmp -f -j DROP

iptables -A INPUT -p tcp -m state --state RELATED,ESTABLISHED -j ACCEPT
iptables -A INPUT -p udp -m state --state RELATED,ESTABLISHED -j ACCEPT


iptables -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT


iptables -A INPUT -p icmp --icmp-type 3 -j ACCEPT
iptables -A INPUT -p icmp --icmp-type 11 -j ACCEPT
iptables -A INPUT -p icmp --icmp-type 12 -j ACCEPT


iptables -A INPUT -p tcp --syn --dport 22 -m recent --name dmitro --set
iptables -A INPUT -p tcp --syn --dport 22 -m recent --name dmitro --update --seconds 30 --hitcount 3 -j DROP
iptables -A INPUT -p tcp --dport 22 -j ACCEPT

iptables -L --line-number
echo
echo "Adding DONE, maybe OK"
echo "Saving to rc, PSE wait!"
service iptables save
echo
service iptables restart
echo "Done"

service iptables restart
service network restart
service openvpn restart

iptables -A INPUT -p tcp --dport 8083 -j ACCEPT
iptables -A INPUT -p tcp -m tcp --dport 80 -j ACCEPT
iptables -A INPUT -p tcp -m tcp --dport 443 -j ACCEPT
iptables -A INPUT -p tcp -m tcp --dport 25 -j ACCEPT
iptables -A INPUT -p tcp -m tcp --dport 465 -j ACCEPT
iptables -A INPUT -p tcp -m tcp --dport 110 -j ACCEPT
iptables -A INPUT -p tcp -m tcp --dport 995 -j ACCEPT
iptables -A INPUT -p tcp -m tcp --dport 143 -j ACCEPT
iptables -A INPUT -p tcp -m tcp --dport 993 -j ACCEPT
iptables -A INPUT -p tcp -m tcp --dport 22 -j ACCEPT</div>
            
          </div>

        

        <div class="spinner spinner-large">
  <div class="bounce1"></div>
  <div class="bounce2"></div>
  <div class="bounce3"></div>
  
</div>


        <div class="content-actions">
  <div class="comment-actions">

    

    
  </div>

  <div class="comment-moderation-actions">
    <ul class="comment-moderation-actions-list ">
      







    </ul>
  </div>
</div>

      </div>
      <div class="clear"></div>
    </div>
    <div class="response-comments">
      <div class="response_comment commentable comment" id="response_comment_4101">


  <div class="comments">
    <ul class="response-list">
      



    </ul>
  </div>


  <div id="reply_anchor_comment_4101"></div>
</div>
    </div>

  </li>

      <li id="comment_4105" data-level="0" class="comment-container">
    <div class="response comment-body-container    " data-highlight="">
      <div class="comment-upvote-container ">
        <button name="button" type="button" class="new-upvote-button" data-include-caret="true" data-upvotable-id="4105" data-upvotable-type="Comment"><span class="icon new-upvote-icon"><svg class="svg-icon svg-icon-upvote-empty"><use xlink:href="https://www.digitalocean.com/assets/community/icon-sprite-d76eb75d70ccf8ffb4c0b47b7dbc88ca.svg#icon-upvote-empty"></use></svg></span><span class="new-upvote-count">0</span></button>
      </div>
      <div class="ox-auto">
        <div class="comment-header">
          <span class="response-name"><a class="username" href="https://www.digitalocean.com/community/users/kamaln7">kamaln7</a></span>
          <span class="mod-badge">MOD</span>
          <span class="response-time"><a rel="nofollow" class="post-time-link" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6?comment=4105">August 30, 2013</a></span>

          
        </div>

          <div class="response-body content-body">
            <div class="legacy">@timepiece: I'm not sure what you mean -- are you having any problems with that script?</div>
            
          </div>

        

        <div class="spinner spinner-large">
  <div class="bounce1"></div>
  <div class="bounce2"></div>
  <div class="bounce3"></div>
  
</div>


        <div class="content-actions">
  <div class="comment-actions">

    

    
  </div>

  <div class="comment-moderation-actions">
    <ul class="comment-moderation-actions-list ">
      







    </ul>
  </div>
</div>

      </div>
      <div class="clear"></div>
    </div>
    <div class="response-comments">
      <div class="response_comment commentable comment" id="response_comment_4105">


  <div class="comments">
    <ul class="response-list">
      



    </ul>
  </div>


  <div id="reply_anchor_comment_4105"></div>
</div>
    </div>

  </li>

      <li id="comment_4132" data-level="0" class="comment-container">
    <div class="response comment-body-container    " data-highlight="">
      <div class="comment-upvote-container ">
        <button name="button" type="button" class="new-upvote-button" data-include-caret="true" data-upvotable-id="4132" data-upvotable-type="Comment"><span class="icon new-upvote-icon"><svg class="svg-icon svg-icon-upvote-empty"><use xlink:href="https://www.digitalocean.com/assets/community/icon-sprite-d76eb75d70ccf8ffb4c0b47b7dbc88ca.svg#icon-upvote-empty"></use></svg></span><span class="new-upvote-count">0</span></button>
      </div>
      <div class="ox-auto">
        <div class="comment-header">
          <span class="response-name"><a class="username" href="https://www.digitalocean.com/community/users/timepiece">timepiece</a></span>
          
          <span class="response-time"><a rel="nofollow" class="post-time-link" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6?comment=4132">August 30, 2013</a></span>

          
        </div>

          <div class="response-body content-body">
            <div class="legacy">Kamal Nasser: it's work. I'm interesting, this script is normal? Can i use it?</div>
            
          </div>

        

        <div class="spinner spinner-large">
  <div class="bounce1"></div>
  <div class="bounce2"></div>
  <div class="bounce3"></div>
  
</div>


        <div class="content-actions">
  <div class="comment-actions">

    

    
  </div>

  <div class="comment-moderation-actions">
    <ul class="comment-moderation-actions-list ">
      







    </ul>
  </div>
</div>

      </div>
      <div class="clear"></div>
    </div>
    <div class="response-comments">
      <div class="response_comment commentable comment" id="response_comment_4132">


  <div class="comments">
    <ul class="response-list">
      



    </ul>
  </div>


  <div id="reply_anchor_comment_4132"></div>
</div>
    </div>

  </li>

      <li id="comment_4188" data-level="0" class="comment-container">
    <div class="response comment-body-container    " data-highlight="">
      <div class="comment-upvote-container ">
        <button name="button" type="button" class="new-upvote-button" data-include-caret="true" data-upvotable-id="4188" data-upvotable-type="Comment"><span class="icon new-upvote-icon"><svg class="svg-icon svg-icon-upvote-empty"><use xlink:href="https://www.digitalocean.com/assets/community/icon-sprite-d76eb75d70ccf8ffb4c0b47b7dbc88ca.svg#icon-upvote-empty"></use></svg></span><span class="new-upvote-count">0</span></button>
      </div>
      <div class="ox-auto">
        <div class="comment-header">
          <span class="response-name"><a class="username" href="https://www.digitalocean.com/community/users/kamaln7">kamaln7</a></span>
          <span class="mod-badge">MOD</span>
          <span class="response-time"><a rel="nofollow" class="post-time-link" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6?comment=4188">August 30, 2013</a></span>

          
        </div>

          <div class="response-body content-body">
            <div class="legacy">@timepiece: I don't recommend downloading scripts and just running them. I suggest you read it and learn what each line does and then write your own rules based on what you need.</div>
            
          </div>

        

        <div class="spinner spinner-large">
  <div class="bounce1"></div>
  <div class="bounce2"></div>
  <div class="bounce3"></div>
  
</div>


        <div class="content-actions">
  <div class="comment-actions">

    

    
  </div>

  <div class="comment-moderation-actions">
    <ul class="comment-moderation-actions-list ">
      







    </ul>
  </div>
</div>

      </div>
      <div class="clear"></div>
    </div>
    <div class="response-comments">
      <div class="response_comment commentable comment" id="response_comment_4188">


  <div class="comments">
    <ul class="response-list">
      



    </ul>
  </div>


  <div id="reply_anchor_comment_4188"></div>
</div>
    </div>

  </li>

      <li id="comment_5236" data-level="0" class="comment-container">
    <div class="response comment-body-container    " data-highlight="">
      <div class="comment-upvote-container ">
        <button name="button" type="button" class="new-upvote-button" data-include-caret="true" data-upvotable-id="5236" data-upvotable-type="Comment"><span class="icon new-upvote-icon"><svg class="svg-icon svg-icon-upvote-empty"><use xlink:href="https://www.digitalocean.com/assets/community/icon-sprite-d76eb75d70ccf8ffb4c0b47b7dbc88ca.svg#icon-upvote-empty"></use></svg></span><span class="new-upvote-count">0</span></button>
      </div>
      <div class="ox-auto">
        <div class="comment-header">
          <span class="response-name"><a class="username" href="https://www.digitalocean.com/community/users/pcristian06">pcristian06</a></span>
          
          <span class="response-time"><a rel="nofollow" class="post-time-link" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6?comment=5236">October  4, 2013</a></span>

          
        </div>

          <div class="response-body content-body">
            <div class="legacy">i did everything in this tutorial .... after doing this none of my subdomains dosen't work anymore , i have zpanel installed .... i flushed all the rules but now i can't connect neither to ssh neither to my website (nor www.domain.com nor domain.com) somebody has a solution ? i keep flushing the rules and still can't get it to work. sorry for my bad english</div>
            
          </div>

        

        <div class="spinner spinner-large">
  <div class="bounce1"></div>
  <div class="bounce2"></div>
  <div class="bounce3"></div>
  
</div>


        <div class="content-actions">
  <div class="comment-actions">

    

    
  </div>

  <div class="comment-moderation-actions">
    <ul class="comment-moderation-actions-list ">
      







    </ul>
  </div>
</div>

      </div>
      <div class="clear"></div>
    </div>
    <div class="response-comments">
      <div class="response_comment commentable comment" id="response_comment_5236">


  <div class="comments">
    <ul class="response-list">
      



    </ul>
  </div>


  <div id="reply_anchor_comment_5236"></div>
</div>
    </div>

  </li>

      <li id="comment_5237" data-level="0" class="comment-container">
    <div class="response comment-body-container    " data-highlight="">
      <div class="comment-upvote-container ">
        <button name="button" type="button" class="new-upvote-button" data-include-caret="true" data-upvotable-id="5237" data-upvotable-type="Comment"><span class="icon new-upvote-icon"><svg class="svg-icon svg-icon-upvote-empty"><use xlink:href="https://www.digitalocean.com/assets/community/icon-sprite-d76eb75d70ccf8ffb4c0b47b7dbc88ca.svg#icon-upvote-empty"></use></svg></span><span class="new-upvote-count">0</span></button>
      </div>
      <div class="ox-auto">
        <div class="comment-header">
          <span class="response-name"><a class="username" href="https://www.digitalocean.com/community/users/pcristian06">pcristian06</a></span>
          
          <span class="response-time"><a rel="nofollow" class="post-time-link" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6?comment=5237">October  4, 2013</a></span>

          
        </div>

          <div class="response-body content-body">
            <div class="legacy">ok now i flushed all and executed: iptables -p input acccept...
now... , how can i secure my droplet and still have access to subdomaines i want to remind you all that i have zpanel installed .... please help :D , thanks in advance</div>
            
          </div>

        

        <div class="spinner spinner-large">
  <div class="bounce1"></div>
  <div class="bounce2"></div>
  <div class="bounce3"></div>
  
</div>


        <div class="content-actions">
  <div class="comment-actions">

    

    
  </div>

  <div class="comment-moderation-actions">
    <ul class="comment-moderation-actions-list ">
      







    </ul>
  </div>
</div>

      </div>
      <div class="clear"></div>
    </div>
    <div class="response-comments">
      <div class="response_comment commentable comment" id="response_comment_5237">


  <div class="comments">
    <ul class="response-list">
      



    </ul>
  </div>


  <div id="reply_anchor_comment_5237"></div>
</div>
    </div>

  </li>

      <li id="comment_5264" data-level="0" class="comment-container">
    <div class="response comment-body-container    " data-highlight="">
      <div class="comment-upvote-container ">
        <button name="button" type="button" class="new-upvote-button" data-include-caret="true" data-upvotable-id="5264" data-upvotable-type="Comment"><span class="icon new-upvote-icon"><svg class="svg-icon svg-icon-upvote-empty"><use xlink:href="https://www.digitalocean.com/assets/community/icon-sprite-d76eb75d70ccf8ffb4c0b47b7dbc88ca.svg#icon-upvote-empty"></use></svg></span><span class="new-upvote-count">0</span></button>
      </div>
      <div class="ox-auto">
        <div class="comment-header">
          <span class="response-name"><a class="username" href="https://www.digitalocean.com/community/users/kamaln7">kamaln7</a></span>
          <span class="mod-badge">MOD</span>
          <span class="response-time"><a rel="nofollow" class="post-time-link" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6?comment=5264">October  6, 2013</a></span>

          
        </div>

          <div class="response-body content-body">
            <div class="legacy">@pcristian06: Which port is zPanel running on? See the <strong>Open up ports for selected services</strong> section.
</div>
            
          </div>

        

        <div class="spinner spinner-large">
  <div class="bounce1"></div>
  <div class="bounce2"></div>
  <div class="bounce3"></div>
  
</div>


        <div class="content-actions">
  <div class="comment-actions">

    

    
  </div>

  <div class="comment-moderation-actions">
    <ul class="comment-moderation-actions-list ">
      







    </ul>
  </div>
</div>

      </div>
      <div class="clear"></div>
    </div>
    <div class="response-comments">
      <div class="response_comment commentable comment" id="response_comment_5264">


  <div class="comments">
    <ul class="response-list">
      



    </ul>
  </div>


  <div id="reply_anchor_comment_5264"></div>
</div>
    </div>

  </li>

      <li id="comment_5324" data-level="0" class="comment-container">
    <div class="response comment-body-container    " data-highlight="">
      <div class="comment-upvote-container ">
        <button name="button" type="button" class="new-upvote-button" data-include-caret="true" data-upvotable-id="5324" data-upvotable-type="Comment"><span class="icon new-upvote-icon"><svg class="svg-icon svg-icon-upvote-empty"><use xlink:href="https://www.digitalocean.com/assets/community/icon-sprite-d76eb75d70ccf8ffb4c0b47b7dbc88ca.svg#icon-upvote-empty"></use></svg></span><span class="new-upvote-count">0</span></button>
      </div>
      <div class="ox-auto">
        <div class="comment-header">
          <span class="response-name"><a class="username" href="https://www.digitalocean.com/community/users/dokishev">dokishev</a></span>
          
          <span class="response-time"><a rel="nofollow" class="post-time-link" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6?comment=5324">October  8, 2013</a></span>

          
        </div>

          <div class="response-body content-body">
            <div class="legacy">I want to use my drop as pptp server to. Please help me to combine this firetabs with
iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE</div>
            
          </div>

        

        <div class="spinner spinner-large">
  <div class="bounce1"></div>
  <div class="bounce2"></div>
  <div class="bounce3"></div>
  
</div>


        <div class="content-actions">
  <div class="comment-actions">

    

    
  </div>

  <div class="comment-moderation-actions">
    <ul class="comment-moderation-actions-list ">
      







    </ul>
  </div>
</div>

      </div>
      <div class="clear"></div>
    </div>
    <div class="response-comments">
      <div class="response_comment commentable comment" id="response_comment_5324">


  <div class="comments">
    <ul class="response-list">
      



    </ul>
  </div>


  <div id="reply_anchor_comment_5324"></div>
</div>
    </div>

  </li>

      <li id="comment_5376" data-level="0" class="comment-container">
    <div class="response comment-body-container    " data-highlight="">
      <div class="comment-upvote-container ">
        <button name="button" type="button" class="new-upvote-button" data-include-caret="true" data-upvotable-id="5376" data-upvotable-type="Comment"><span class="icon new-upvote-icon"><svg class="svg-icon svg-icon-upvote-empty"><use xlink:href="https://www.digitalocean.com/assets/community/icon-sprite-d76eb75d70ccf8ffb4c0b47b7dbc88ca.svg#icon-upvote-empty"></use></svg></span><span class="new-upvote-count">0</span></button>
      </div>
      <div class="ox-auto">
        <div class="comment-header">
          <span class="response-name"><a class="username" href="https://www.digitalocean.com/community/users/kamaln7">kamaln7</a></span>
          <span class="mod-badge">MOD</span>
          <span class="response-time"><a rel="nofollow" class="post-time-link" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6?comment=5376">October  9, 2013</a></span>

          
        </div>

          <div class="response-body content-body">
            <div class="legacy">@higet: You just have to run that command as root and pptp should work.</div>
            
          </div>

        

        <div class="spinner spinner-large">
  <div class="bounce1"></div>
  <div class="bounce2"></div>
  <div class="bounce3"></div>
  
</div>


        <div class="content-actions">
  <div class="comment-actions">

    

    
  </div>

  <div class="comment-moderation-actions">
    <ul class="comment-moderation-actions-list ">
      







    </ul>
  </div>
</div>

      </div>
      <div class="clear"></div>
    </div>
    <div class="response-comments">
      <div class="response_comment commentable comment" id="response_comment_5376">


  <div class="comments">
    <ul class="response-list">
      



    </ul>
  </div>


  <div id="reply_anchor_comment_5376"></div>
</div>
    </div>

  </li>

      <li id="comment_5450" data-level="0" class="comment-container">
    <div class="response comment-body-container    " data-highlight="">
      <div class="comment-upvote-container ">
        <button name="button" type="button" class="new-upvote-button" data-include-caret="true" data-upvotable-id="5450" data-upvotable-type="Comment"><span class="icon new-upvote-icon"><svg class="svg-icon svg-icon-upvote-empty"><use xlink:href="https://www.digitalocean.com/assets/community/icon-sprite-d76eb75d70ccf8ffb4c0b47b7dbc88ca.svg#icon-upvote-empty"></use></svg></span><span class="new-upvote-count">0</span></button>
      </div>
      <div class="ox-auto">
        <div class="comment-header">
          <span class="response-name"><a class="username" href="https://www.digitalocean.com/community/users/loranbriggs">loranbriggs</a></span>
          
          <span class="response-time"><a rel="nofollow" class="post-time-link" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6?comment=5450">October 12, 2013</a></span>

          
        </div>

          <div class="response-body content-body">
            <div class="legacy">I entered:
iptables -A PREROUTING -t nat -i eth1 -p tcp --dport 80 -j REDIRECT --to-port 8080
 
to redirect port 80, I am now trying to undo that and have entered both
sudo iptables --flush
and
sudo iptables -F

to no avail, no error and port forwarding still taking place. Any clues? thanks!</div>
            
          </div>

        

        <div class="spinner spinner-large">
  <div class="bounce1"></div>
  <div class="bounce2"></div>
  <div class="bounce3"></div>
  
</div>


        <div class="content-actions">
  <div class="comment-actions">

    

    
  </div>

  <div class="comment-moderation-actions">
    <ul class="comment-moderation-actions-list ">
      







    </ul>
  </div>
</div>

      </div>
      <div class="clear"></div>
    </div>
    <div class="response-comments">
      <div class="response_comment commentable comment" id="response_comment_5450">


  <div class="comments">
    <ul class="response-list">
      



    </ul>
  </div>


  <div id="reply_anchor_comment_5450"></div>
</div>
    </div>

  </li>

      <li id="comment_5469" data-level="0" class="comment-container">
    <div class="response comment-body-container    " data-highlight="">
      <div class="comment-upvote-container ">
        <button name="button" type="button" class="new-upvote-button" data-include-caret="true" data-upvotable-id="5469" data-upvotable-type="Comment"><span class="icon new-upvote-icon"><svg class="svg-icon svg-icon-upvote-empty"><use xlink:href="https://www.digitalocean.com/assets/community/icon-sprite-d76eb75d70ccf8ffb4c0b47b7dbc88ca.svg#icon-upvote-empty"></use></svg></span><span class="new-upvote-count">0</span></button>
      </div>
      <div class="ox-auto">
        <div class="comment-header">
          <span class="response-name"><a class="username" href="https://www.digitalocean.com/community/users/kamaln7">kamaln7</a></span>
          <span class="mod-badge">MOD</span>
          <span class="response-time"><a rel="nofollow" class="post-time-link" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6?comment=5469">October 12, 2013</a></span>

          
        </div>

          <div class="response-body content-body">
            <div class="legacy">@loranbriggs: Try <code>sudo iptables -D PREROUTING -t nat -i eth1 -p tcp --dport 80 -j REDIRECT --to-port 8080
</code>

It should delete the rules.</div>
            
          </div>

        

        <div class="spinner spinner-large">
  <div class="bounce1"></div>
  <div class="bounce2"></div>
  <div class="bounce3"></div>
  
</div>


        <div class="content-actions">
  <div class="comment-actions">

    

    
  </div>

  <div class="comment-moderation-actions">
    <ul class="comment-moderation-actions-list ">
      







    </ul>
  </div>
</div>

      </div>
      <div class="clear"></div>
    </div>
    <div class="response-comments">
      <div class="response_comment commentable comment" id="response_comment_5469">


  <div class="comments">
    <ul class="response-list">
      



    </ul>
  </div>


  <div id="reply_anchor_comment_5469"></div>
</div>
    </div>

  </li>

      <li id="comment_5507" data-level="0" class="comment-container">
    <div class="response comment-body-container    " data-highlight="">
      <div class="comment-upvote-container ">
        <button name="button" type="button" class="new-upvote-button" data-include-caret="true" data-upvotable-id="5507" data-upvotable-type="Comment"><span class="icon new-upvote-icon"><svg class="svg-icon svg-icon-upvote-empty"><use xlink:href="https://www.digitalocean.com/assets/community/icon-sprite-d76eb75d70ccf8ffb4c0b47b7dbc88ca.svg#icon-upvote-empty"></use></svg></span><span class="new-upvote-count">0</span></button>
      </div>
      <div class="ox-auto">
        <div class="comment-header">
          <span class="response-name"><a class="username" href="https://www.digitalocean.com/community/users/sohail0">sohail0</a></span>
          
          <span class="response-time"><a rel="nofollow" class="post-time-link" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6?comment=5507">October 13, 2013</a></span>

          
        </div>

          <div class="response-body content-body">
            <div class="legacy">I used this guide but now unable to install anything using yum. I get "Temporary failure in name resolution" error. When I stop iptables, it works fine. Please advise.</div>
            
          </div>

        

        <div class="spinner spinner-large">
  <div class="bounce1"></div>
  <div class="bounce2"></div>
  <div class="bounce3"></div>
  
</div>


        <div class="content-actions">
  <div class="comment-actions">

    

    
  </div>

  <div class="comment-moderation-actions">
    <ul class="comment-moderation-actions-list ">
      







    </ul>
  </div>
</div>

      </div>
      <div class="clear"></div>
    </div>
    <div class="response-comments">
      <div class="response_comment commentable comment" id="response_comment_5507">


  <div class="comments">
    <ul class="response-list">
      



    </ul>
  </div>


  <div id="reply_anchor_comment_5507"></div>
</div>
    </div>

  </li>

      <li id="comment_5837" data-level="0" class="comment-container">
    <div class="response comment-body-container    " data-highlight="">
      <div class="comment-upvote-container ">
        <button name="button" type="button" class="new-upvote-button" data-include-caret="true" data-upvotable-id="5837" data-upvotable-type="Comment"><span class="icon new-upvote-icon"><svg class="svg-icon svg-icon-upvote-empty"><use xlink:href="https://www.digitalocean.com/assets/community/icon-sprite-d76eb75d70ccf8ffb4c0b47b7dbc88ca.svg#icon-upvote-empty"></use></svg></span><span class="new-upvote-count">0</span></button>
      </div>
      <div class="ox-auto">
        <div class="comment-header">
          <span class="response-name"><a class="username" href="https://www.digitalocean.com/community/users/parknima">parknima</a></span>
          
          <span class="response-time"><a rel="nofollow" class="post-time-link" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6?comment=5837">October 23, 2013</a></span>

          
        </div>

          <div class="response-body content-body">
            <div class="legacy">hi,
I use this tutorial and then my FTP client (filezilla) can't connect to the server. I've open the port 21 for the FTP but it stuck at:
Command:	PASV
Response:	227 Entering Passive Mode (162,217,250,73,163,48)
Command:	MLSD</div>
            
          </div>

        

        <div class="spinner spinner-large">
  <div class="bounce1"></div>
  <div class="bounce2"></div>
  <div class="bounce3"></div>
  
</div>


        <div class="content-actions">
  <div class="comment-actions">

    

    
  </div>

  <div class="comment-moderation-actions">
    <ul class="comment-moderation-actions-list ">
      







    </ul>
  </div>
</div>

      </div>
      <div class="clear"></div>
    </div>
    <div class="response-comments">
      <div class="response_comment commentable comment" id="response_comment_5837">


  <div class="comments">
    <ul class="response-list">
      



    </ul>
  </div>


  <div id="reply_anchor_comment_5837"></div>
</div>
    </div>

  </li></ul><div class="comment-pagination"><span class="previous_page disabled">Previous</span> <em class="current">1</em> <a rel="next nofollow" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6/comments?page=2">2</a> <a rel="nofollow" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6/comments?page=3">3</a> <a rel="nofollow" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6/comments?page=4">4</a> <a rel="nofollow" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6/comments?page=5">5</a> <a class="next_page" rel="next nofollow" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6/comments?page=2">Next</a></div>

      <div class="comments-spinner" style="display: none;"><div class="spinner spinner-large">
  <div class="bounce1"></div>
  <div class="bounce2"></div>
  <div class="bounce3"></div>
  
</div>
</div>
  </div>

  <div class="load-more-container"><a class="load-more" href="javascript:void(0);"><span class="load-more-text">Load More Comments</span><div class="comments-spinner" style="display: none;"><div class="spinner spinner-large">
  <div class="bounce1"></div>
  <div class="bounce2"></div>
  <div class="bounce3"></div>
  
</div>
</div></a></div>
</div>


  </div>
</div>

<div class="creative-commons">
  <a class="creative-commons-image" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img rel="license" alt="Creative Commons License" src="./How To Set Up a Basic Iptables Firewall on Centos 6 _ DigitalOcean_files/creativecommons-08b32a9279fcd47fcd78ac6a26331389.png"></a>
    <div class="license-text">This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.</div>
</div>





        <div class="clearfix"></div>
      </div>


      <footer class="Footer">
  <span class="Footer-logo icon-sammy"></span>

  <div>Copyright © 2017 DigitalOcean™ Inc.</div>

  <ul class="Footer-nav">
    <li><a href="https://www.digitalocean.com/community">Community</a></li>
    <li><a href="https://www.digitalocean.com/community/tutorials">Tutorials</a></li>
    <li><a href="https://www.digitalocean.com/community/questions">Questions</a></li>
    <li><a href="https://www.digitalocean.com/community/projects">Projects</a></li>
    <li><a href="https://www.digitalocean.com/community/tags">Tags</a></li>
    <li><a href="https://www.digitalocean.com/community/newsletter">Newsletter</a></li>
    <li>
      <a href="https://www.digitalocean.com/community/tutorials/feed">
        RSS <span class="icon-rss"></span>
</a>    </li>
  </ul>

  <br>

  <ul class="Footer-nav Footer-nav--secondary">
    <li><a href="https://www.digitalocean.com/features/one-click-apps/">Distros &amp; One-Click Apps</a></li>
    <li><a href="https://www.digitalocean.com/legal/terms/">Terms, Privacy, &amp; Copyright</a></li>
    <li><a href="https://www.digitalocean.com/security/">Security</a></li>
      <li><a data-toggle="modal" data-target="#sign-in-modal" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6#">Report a Bug</a></li>
    <li><a href="https://www.digitalocean.com/community/write-for-digitalocean">Write for DigitalOcean</a></li>
    <li><a href="http://store.digitalocean.com/">Shop</a></li>
  </ul>
</footer>





      <div id="sign-in-modal" class="modal fade mini-modal" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1>Almost there!</h1>
        <a class="close-button" data-dismiss="modal" aria-label="close" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6"><span class="icon icon-close-light"></span></a>
      </div>
      <div class="modal-body">
        <div class="sign-in-message">Sign into your account, or create a new one, to start interacting.</div>

        <div class="sign-in-modal-actions">
          <a class="sign-in-link button blue-button" data-default-url="/community/auth/digitalocean" href="https://www.digitalocean.com/community/auth/digitalocean">Log In</a>
          <a class="sign-up-link button green-button" data-default-url="/community/auth/digitalocean?display=sessionless+register" href="https://www.digitalocean.com/community/auth/digitalocean?display=sessionless+register">Sign Up</a>
        </div>
      </div>
    </div>
  </div>
</div>



    
  <script>
    $(function() {
      if (!!window.init_sharing) {
        window.init_sharing();
      }
      new window.NewsletterSignup();
      new window.GrowableMarkdown({ target: '[data-growable-markdown]' });

      window.Bugsnag.beforeNotify = function(payload, metaData) {
        // custom logic to determine groupingHash
        metaData.groupingHash = "tutorialShow";
      }
    });
  </script>
  <script type="application/ld+json">
    {"@context":"http://schema.org","@type":"Article","name":"How To Set Up a Basic Iptables Firewall on Centos 6","headline":"How To Set Up a Basic Iptables Firewall on Centos 6","alternativeHeadline":"How To Set Up a Basic Iptables Firewall on Centos 6","description":"This article will show how to create a simple firewall on a Centos VPS. It will only open up ports that we want and close up other services. We'll also demonstrate how to prevent simpler attacks, and how to let yourself back in to the VPS if you deny access to yourself by accident.","keywords":"Firewall,Security","url":"https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6"},"dateModified":"2016-10-13T17:14:41Z","inLanguage":"en","accessMode":"textual","accessModeSufficient":"textual","isAccessibleForFree":true,"license":"https://creativecommons.org/licenses/by-nc-sa/4.0/","publishingPrinciples":"https://www.digitalocean.com/community/tutorials/technical-recommendations-and-best-practices-for-digitalocean-s-tutorials","author":{"@type":"Person","name":""},"datePublished":"2013-04-16T14:25:11Z","image":{"@type":"ImageObject","url":"https://www.digitalocean.com/assets/community/default_community_sharing-65c1cc547375d6e37cc45195b3686769.png","height":375,"width":750},"interactionStatistic":[{"@type":"InteractionCounter","interactionType":"http://schema.org/LikeAction","userInteractionCount":"37"},{"@type":"InteractionCounter","interactionType":"http://schema.org/CommentAction","userInteractionCount":"85"}],"sourceOrganization":{"@type":"Organization","name":"DigitalOcean Community","url":"https://www.digitalocean.com/community"},"publisher":{"@type":"Organization","name":"DigitalOcean","url":"https://www.digitalocean.com","logo":{"@type":"ImageObject","url":"https://assets.digitalocean.com/logos/DO_Logo_horizontal_blue.png","width":351,"height":60}}}
  </script>

  <div id="report-a-bug-modal" class="modal fade mini-modal" style="display: none;">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1>Report a Bug</h1>
          <a class="close-button" data-dismiss="modal" aria-label="close" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6"><span class="icon icon-close-light"></span></a>
        </div>
        <div class="modal-body">
          <div class="report-a-bug-message text-center">Use this form to report bugs related to the Community</div>
          <div class="report-a-bug-actions do-form">
            <div class="form-wrap">
              <form class="new_bug_report" id="new_bug_report" action="https://www.digitalocean.com/community/bug_reports" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="✓"><input type="hidden" name="authenticity_token" value="nVr9Sz6d9Bh/ACaQQfSSjOfBt1mzxepL72M+GE8cE6nFNLPz+ADcmZSnDPdlFA9nfxxLMHe6HhZg2DYH/Yx7Xg==">
                <fieldset name="report-a-bug-info">
                <legend class="sr-only">Report a bug:</legend>
                  <div class="field">
                    <label for="bug_reporter_name" class="sr-only">Name</label>
                    <input placeholder="Name" id="bug_reporter_name" type="text" name="bug_report[name]">
                  </div>
                  <div class="field">
                    <label for="bug_reporter_email" class="sr-only">Email</label>
                    <input name="Email" placeholder="Email" id="bug_reporter_email" required="required" type="text">
                  </div>
                  <div class="field">
                    <label for="bug_reporter_message" class="sr-only">Message</label>
                    <textarea name="Message" placeholder="Message" id="bug_reporter_message" required="required" style="overflow: hidden; word-wrap: break-word; resize: none; height: 125px;"></textarea>
                  </div>

                  <div class="field actions">
                    <input type="submit" name="commit" value="Submit" class="button">
                  </div>
                </fieldset>
</form>            </div>
          </div>
        </div>
      </div>
    </div>
  </div>


    
  

<textarea tabindex="-1" aria-hidden="true" ,="" style="position: absolute; top: -999px; left: 0px; right: auto; bottom: auto; border: 0px; padding: 0px; box-sizing: content-box; word-wrap: break-word; overflow: hidden; transition: none; height: 0px !important; min-height: 0px !important; font-family: proxima-nova, sans-serif; font-size: 17px; font-weight: 400; font-style: normal; letter-spacing: 0px; text-transform: none; word-spacing: 0px; text-indent: 0px; line-height: normal; width: 58px;" class="autosizejs" id="autosizejs"></textarea><a id="scrollUp" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-basic-iptables-firewall-on-centos-6#top" style="position: fixed; z-index: 1000;">Scroll to top</a><div id="scrollUp-active" style="position: absolute; top: 300px; width: 100%; border-top: 1px dotted rgb(0, 255, 255); z-index: 1000;"></div><div id="mktoStyleLoaded" style="display: none; border-top-color: rgb(18, 52, 86);"></div><script type="text/javascript" id="">var wait_count=0,jQWait=window.setInterval(function(){window.jQuery&&function(){window.clearInterval(window.jQWait);var f=window.BelowTutorialPanel=function(b){$.extend(this,{activeTest:"default",panelBodyTarget:"div.tutorial-ctas",panelContentTarget:"div.cta-description",relatedLinksTarget:"div.related-tutorials",tagSelector:'a.tag:contains("$TAG")',experimentName:"Below Tutorial Panel",tutorialRecommendationPath:"https://assets.digitalocean.com/labs/tutorial_recommendations/",scrollCheckInterval:1E3},
b||{},{event_fired:!1});this.initialize()};$.extend(f.prototype,{initialize:function(){this.$panelBody=$($(this.panelBodyTarget).get(0));this.$relatedLinks=$(this.relatedLinksTarget);this.userTraits={};this.analyticsActive()&&(this.userTraits=window.analytics.user().traits());this.audience=this.getAudience(Object.keys(this.panelData),this.parseCookies(document.cookie),this.userTraits);this.panel=this.getPanel(this.panelData[this.audience]);this.panelContent=this.panel.content[Math.floor(Math.random()*
this.panel.content.length)];this.$panelBody.attr("style",this.panel.style).find("h2").text(this.panelContent.title||"").css({color:this.panel.darkBG?"#FFF":"inherit"}).end().find("p").html(this.panelContent.desc||"").css({color:this.panel.darkBG?"#FFF":"inherit",padding:"15px 0","line-height":"1.3em"}).end().find(".cloud-tutorial-cta").text(this.panelContent.cta||"").attr("style",this.panel.darkBG?"background:#FFF;color:#0069FF;":"").attr("href",this.panelContent.url+(0<this.panelContent.url.indexOf("?")?
"\x26":"?")+"utm_source\x3dcomm_exp\x26utm_medium\x3dbtp_"+this.audience+"_"+this.panel.name);"recommendation_algo"===this.panel.name?this.loadRecommendations($("body").data("tutorial-id"),this.panel.template,this.panel.template_short):this.initTracking(this.$panelBody.offset().top,this.$panelBody.height(),this.audience+" \x3e "+this.panel.name+" \x3e "+this.panelContent.cta||"",this.$panelBody.find("a"))},loadRecommendations:function(b,e,a){$.getJSON(this.tutorialRecommendationPath+b+".json",function(a){var b=
a.length,c,g,f="{SLUG} {TITLE} {DESC} {LIKES} {DATE} {COMMENTS}".split(" "),k="";if(0<b){for(c=0;c<b&&2>c;c++){var h=e;for(g=0;g<f.length;g++)h=h.replace(f[g],a[c][g]);k+=h.replace("{FIRST}",0==c?"margin-right:15px;":"")}this.$panelBody.find("h2").after('\x3cdiv style\x3d"text-align:center; padding:15px 0;"\x3e'+k+"\x3c/div\x3e").end().find("p, .cloud-tutorial-cta").remove();this.$relatedLinks.remove();this.initTracking(this.$panelBody.offset().top,this.$panelBody.height(),this.audience+" \x3e "+
this.panel.name+" \x3e "+this.panelContent.cta||"",this.$panelBody.find("a"))}}.bind(this)).error(function(){var b="",d;for(d=0;4>d;d++)b+=a.replace("{FIRST}",0==d%2?"margin-right:15px;":"").replace("{TITLE}",this.$relatedLinks.find(".related-link").eq(d).text()).replace("{SLUG}",this.$relatedLinks.find(".related-link").eq(d).attr("href"));this.$panelBody.find("h2").after('\x3cdiv style\x3d"text-align:center; padding:15px 0;"\x3e'+b+"\x3c/div\x3e").end().find("p, .cloud-tutorial-cta").remove();this.$relatedLinks.remove();
this.initTracking(this.$panelBody.offset().top,this.$panelBody.height(),this.audience+" (fallback) \x3e "+this.panel.name+" \x3e "+this.panelContent.cta||"",this.$panelBody.find("a"))}.bind(this))},getPanel:function(b){var e=b.length,a,c,d=[];for(a=0;a<e;a++){if("tags"in b[a])for(c=0;c<b[a].tags.length;c++)if(0<$(this.tagSelector.replace("$TAG",b[a].tags[c])).length)return b[a];"priority"in b[a]&&d.push({panel:a,priority:b[a].priority})}if(0<d.length)for(a=0;a<d.length;a++)if(Math.random()<d[a].priority)return b[d[a].panel];
return b[Math.floor(Math.random()*e)]},getAudience:function(b,e,a){return-1<b.indexOf("customers")&&("signed_in"in e||"ajs_user_id"in e&&10<e.ajs_user_id.length)?"customers":-1<b.indexOf("refcode")&&"refcode"in e?"refcode":-1<b.indexOf("buildmode")&&"recent"in a&&a.recent instanceof Array&&4===a.recent.length&&2===a.recent[3].length&&8>Math.round(+new Date/864E5)-a.recent[3][1]?"buildmode":-1<b.indexOf("regulars")&&"recent"in a&&a.recent instanceof Array&&4===a.recent.length&&2===a.recent[3].length&&
30>Math.round(+new Date/864E5)-a.recent[3][1]?"regulars":"everyone_else"},analyticsActive:function(){return"object"===typeof window.analytics},parseCookies:function(b){b=b.split(";");var e={},a;for(a=0;a<b.length;a++){var c=b[a].split("\x3d");e[c[0].trim()]=c[1].trim()}return e},convertToId:function(b){return"string"===typeof b?b.replace(/\W+/g,"_").toLowerCase():""},initTracking:function(b,e,a,c){if(this.analyticsActive()){var d,f=window.setInterval(function(){d=$(window).scrollTop();d+$(window).height()>
b-e&&(window.clearInterval(f),analytics.track("Experiment Viewed",{experimentId:this.convertToId(this.experimentName),experimentName:this.experimentName,variationId:this.convertToId(a),variationName:a}))}.bind(this),1E3);analytics.trackLink(c,"Experiment Success",{experimentId:this.convertToId(this.experimentName),experimentName:this.experimentName,variationId:this.convertToId(a),variationName:a})}}});new f({panelData:{refcode:[{name:"referrals",style:"background-image:url(https://assets.digitalocean.com/labs/btp/referrals.png); background-color:#1b78f8; background-position:bottom center;",
darkBG:!0,content:[{title:"Your free credit awaits!",desc:"Sign up to redeem your credit, and start deploying your sites and apps within minutes.",cta:"Use Your Credit",url:"https://cloud.digitalocean.com/registrations/new"},{title:"Free credit active.",desc:"You came to digitalocean.com via someone\x26apos;s referral link in the past month,\x3cbr\x3e making you eligible for $10 credit when you sign up for an account.",cta:"Redeem Credit",url:"https://cloud.digitalocean.com/registrations/new"}]}],
customers:[{name:"currents",priority:.2,style:"background-image:url(https://assets.digitalocean.com/labs/btp/currents.png); background-color:#1b78f8; background-position:bottom center; padding-top:-10px;",darkBG:!0,content:[{title:"Announcing DigitalOcean Currents",desc:"Check out our inaugural quarterly report on developer cloud trends",cta:"Read the Report",url:"https://blog.digitalocean.com/currents-developer-report/"}]},{name:"write4do",style:"background-image:url(https://assets.digitalocean.com/labs/btp/write4do.png); background-color:#1b78f8; background-position:bottom center; background-repeat-x:repeat;",
darkBG:!0,content:[{title:"Write for DigitalOcean",desc:"Share your technical expertise with an audience of millions.",cta:"Learn More",url:"https://www.digitalocean.com/community/write-for-digitalocean"}]},{name:"objectstorage",priority:.2,style:"background-image:url(https://assets.digitalocean.com/labs/btp/objectstorage.png), linear-gradient(to right, #04338b, #040434);  background-position:bottom center; padding-top:-10px;",darkBG:!0,content:[{title:"Introducing Spaces: Object Storage on DigitalOcean",
desc:"A simple and cost-effective way to store, serve, backup, and archive a virtually infinite amount of media, content, images, and static files for your apps.",cta:"Try free for 2 months",url:"https://cloud.digitalocean.com/spaces"}]},{name:"meetups",style:"background-image:url(https://assets.digitalocean.com/labs/btp/meetups.png); background-color:#172232; background-position:bottom center; padding-top:-10px;",darkBG:!0,content:[{title:"DigitalOcean, live from your hometown",desc:"Meet developers of all skill levels to share resources and form discussions around cloud and DevOps topics. Attend a meetup, start one in your city, or apply to speak at one near you.",
cta:"Find a Meetup",url:"https://www.meetup.com/pro/digitalocean/"}]}],buildmode:[{name:"ft_test",style:"background-image:url(https://assets.digitalocean.com/labs/btp/general.png); background-color:#1b78f8; background-position:bottom center; overflow:hidden;",darkBG:!0,content:[{title:"Get started on DigitalOcean with free $10 credit",desc:"You\u2019ve read five tutorials on DigitalOcean this week and are well on your way to managing your infrastructure. Test your newfound knowledge by trying out DigitalOcean with $10 in free credit.",
cta:"Create a Free Account",url:"https://cloud.digitalocean.com/registrations/new?refcode\x3d74a1c5d63dac"},{title:"Get started on DigitalOcean with free $10 credit",desc:"Cheers to you, voracious reader of Community Tutorials. You've read five tutorials in the last week!\x3cbr/\x3eIf you haven't already spun up servers on DO, here's $10 to give it a try.",cta:"Create an Account to Redeem Credit",url:"https://cloud.digitalocean.com/registrations/new?refcode\x3d74a1c5d63dac"}]}],regulars:[{name:"deploy",
content:[{title:"Spin up an SSD cloud server in under a minute.",desc:"Simple setup. Full root access. Straightforward pricing.",cta:"Deploy Server",url:"https://cloud.digitalocean.com/registrations/new"}]},{name:"write4do",style:"background-image:url(https://assets.digitalocean.com/labs/btp/write4do.png); background-color:#1b78f8; background-position:bottom center; background-repeat-x:repeat;",darkBG:!0,content:[{title:"Write for DigitalOcean",desc:"Share your technical expertise with an audience of millions.",
cta:"Learn More",url:"https://www.digitalocean.com/community/write-for-digitalocean"}]},{name:"meetups",style:"background-image:url(https://assets.digitalocean.com/labs/btp/meetups.png); background-color:#172232; background-position:bottom center; padding-top:-10px;",darkBG:!0,content:[{title:"DigitalOcean, live from your hometown",desc:"Meet developers of all skill levels to share resources and form discussions around cloud and DevOps topics. Attend a meetup, start one in your city, or apply to speak at one near you.",
cta:"Find a Meetup",url:"https://www.meetup.com/pro/digitalocean/"}]},{name:"objectstorage",style:"background-image:url(https://assets.digitalocean.com/labs/btp/objectstorage.png), linear-gradient(to right, #04338b, #040434); background-position:bottom center; padding-top:-10px;",darkBG:!0,content:[{title:"Introducing Object Storage",desc:"Store and serve a virtually unlimited amount of data. Sign up for early access and receive 1TB of free usage until October 31, 2017.",cta:"Learn More",url:"https://www.digitalocean.com/products/storage/object-storage/"}]}],
everyone_else:[{name:"writedev4do",style:"background-image:url(https://assets.digitalocean.com/labs/btp/write4do.png); background-color:#1b78f8; background-position:bottom center; background-repeat-x:repeat;",darkBG:!0,content:[{title:"Share your software development expertise with the world!",desc:"We want to publish your tutorials that show how to build apps with Python and JavaScript.",cta:"Write for DigitalOcean",url:"https://www.digitalocean.com/community/write-for-digitalocean"}]},{name:"d4d",
style:"background-image:url(https://assets.digitalocean.com/labs/btp/d4d.png); background-color:#1b78f8; background-position:bottom center; padding-top:-10px;",darkBG:!0,content:[{title:"Need free Droplets for a presentation? Let\u2019s talk.",desc:"Receive free infrastructure credits to power your next tech talk or live demo. ",cta:"Learn More",url:"https://www.digitalocean.com/droplets-for-demos/"},{title:"Open Source Presentation Grants",desc:"Receive free infrastructure credits to power your next tech talk or live demo. ",
cta:"Learn More",url:"https://www.digitalocean.com/droplets-for-demos/"}]},{name:"currents",style:"background-image:url(https://assets.digitalocean.com/labs/btp/currents.png); background-color:#1b78f8; background-position:bottom center; padding-top:-10px;",darkBG:!0,content:[{title:"Announcing DigitalOcean Currents",desc:"Check out our inaugural quarterly report on developer cloud trends",cta:"Read the Report",url:"https://blog.digitalocean.com/currents-developer-report/"}]},{name:"objectstorage",
style:"background-image:url(https://assets.digitalocean.com/labs/btp/objectstorage.png), linear-gradient(to right, #04338b, #040434);  background-position:bottom center; padding-top:-10px;",darkBG:!0,content:[{title:"Introducing Spaces: Object Storage on DigitalOcean",desc:"A simple and cost-effective way to store, serve, backup, and archive a virtually infinite amount of media, content, images, and static files for your apps.",cta:"Try free for 2 months",url:"https://cloud.digitalocean.com/registrations/new?onboarding_origin\x3dspaces"}]}]}})}();
10<wait_count++&&window.clearInterval(window.jQWait)},100);</script><script type="text/javascript" id="">(function(){try{analytics&&analytics.ready(function(){var c=analytics.user().traits(),a=c.recent||[],d=[$("body").data("tutorial-id")||"",Math.round(new Date/864E5)],e=a.length,b;for(b=0;b<e;b++)if(a[b]instanceof Array&&a[b][0]===d[0]){a.splice(b,1);break}a.unshift(d);5<=a.length&&a.pop();c.recent=a;analytics.user().traits(c)})}catch(c){}})();</script><script type="text/javascript" id="">try{document.addEventListener("copy",function(a){window.getSelection&&$(window.getSelection().anchorNode).parents("pre").length&&analytics.track("Web Interaction",{action:"Code Copy",name:window.getSelection().toString().substring(0,64)+(64<window.getSelection().toString().length?"\u2026":"")})})}catch(a){};</script><div id="fb-root" class=" fb_reset"><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div><iframe name="fb_xdm_frame_https" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" id="fb_xdm_frame_https" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" src="./How To Set Up a Basic Iptables Firewall on Centos 6 _ DigitalOcean_files/lY4eZXm_YWu.html" style="border: none;"></iframe></div></div><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div></div></div></div><form novalidate="novalidate" class="mktoForm mktoHasWidth mktoLayoutLeft" style="font-family: Helvetica, Arial, sans-serif; font-size: 13px; color: rgb(51, 51, 51); visibility: hidden; position: absolute; top: -500px; left: -1000px; width: 1905px;"></form><iframe name="mktoFormsXDIframe0.6805296182423117" id="MktoForms2XDIframe" src="./How To Set Up a Basic Iptables Firewall on Centos 6 _ DigitalOcean_files/XDFrame.html" style="display: none;"></iframe><script type="text/javascript" id="">(function(a,b,c,d,e){a=b.createElement(c);b=b.getElementsByTagName(c)[0];a.async=1;a.id=e;a.src=d;b.parentNode.insertBefore(a,b)})(window,document,"script","https://scripts.demandbase.com/014ab3bd.min.js","demandbase_js_lib");</script><img style="display:none" alt="" aria-hidden="true" id="db_pixel_ad" src="./How To Set Up a Basic Iptables Firewall on Centos 6 _ DigitalOcean_files/pixel"><img style="display:none" alt="" aria-hidden="true" id="db_pixel_rt" src="./How To Set Up a Basic Iptables Firewall on Centos 6 _ DigitalOcean_files/pixel(1)"><div id="gtx-trans" style="position: absolute; left: 763px; top: 2987px;"><div class="gtx-trans-icon"></div></div></body></html>